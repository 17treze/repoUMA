function _createForOfIteratorHelper(e,i){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||i&&e&&"number"==typeof e.length){t&&(e=t);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){s=!0,o=e},f:function(){try{r||null==t.return||t.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,i){if(e){if("string"==typeof e)return _arrayLikeToArray(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,i):void 0}}function _arrayLikeToArray(e,i){(null==i||i>e.length)&&(i=e.length);for(var t=0,a=new Array(i);t<i;t++)a[t]=e[t];return a}function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,i){for(var t=0;t<i.length;t++){var a=i[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,i,t){return i&&_defineProperties(e.prototype,i),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{GFTO:function(e,i,t){"use strict";t.d(i,"a",(function(){return n}));var a=function(){function e(i,t){_classCallCheck(this,e),this.label=i,this.data=t}return _createClass(e,null,[{key:"fromEnteSede",value:function(i){return new e(i.descrizione,i)}}]),e}(),n=function(){function e(i,t,a){_classCallCheck(this,e),this.label=i,this.data=t,this.children=a,this.partialSelected=!1}return _createClass(e,null,[{key:"getTreeNode",value:function(i){var t=[];if(void 0!==i.sedi){var n,o=_createForOfIteratorHelper(i.sedi);try{for(o.s();!(n=o.n()).done;){var r=n.value;t.push(a.fromEnteSede(r))}}catch(s){o.e(s)}finally{o.f()}}return new e(i.descrizione,i.id,t)}},{key:"getTreeNodes",value:function(i){var t=[];i.sort((function(e,i){return e.descrizione>i.descrizione?1:e.descrizione<i.descrizione?-1:0}));var a,n=_createForOfIteratorHelper(i);try{for(n.s();!(a=n.n()).done;){var o=a.value;o.sedi.sort((function(e,i){return e.descrizione>i.descrizione?1:e.descrizione<i.descrizione?-1:0})),t.push(e.getTreeNode(o))}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"selectEntiSedi",value:function(e,i){var t=[];return i&&e.forEach((function(e,a){var n=0;e.children.forEach((function(e,a){i.find((function(i){return i==e.data.id.valueOf()}))&&(t.push(e),n++)})),n>0&&(n===e.children.length?t=t.concat([e],e.children):e.partialSelected=!0)})),t}}]),e}()},rL0V:function(e,i,t){"use strict";t.r(i),t.d(i,"UtentiModule",(function(){return ri}));var a=t("tyNb"),n=t("fXoL"),o=t("JEAp"),r=t("bOdf"),s=t("Tn7N"),l=t("1vA5"),c=t("q6l6"),u=t("dkQB"),d=t("5gIc"),b=function(e){return e[e.TI=0]="TI",e[e.LR=1]="LR",e[e.LPC=2]="LPC",e[e.PAT=3]="PAT",e[e.CAA=4]="CAA",e[e.ALTRI=5]="ALTRI",e[e.DIPENDENTE_DISTRIBUTORE=6]="DIPENDENTE_DISTRIBUTORE",e}({}),p=function(e){return e.RIDOTTA_AZIENDA="RIDOTTA_AZIENDA",e.COMPLETA="COMPLETA",e}({}),f=function e(){_classCallCheck(this,e),this.data=new Date},h=function e(i,t,a,n,o,r){_classCallCheck(this,e),this.idResponsabilita=i,this.codResponsabilita=b[b.ALTRI],this.denominazione=t,this.dirigente=n,this.piva=a,this.allegato=o,this.note=r},g=function e(i,t,a,n){_classCallCheck(this,e),this.idResponsabilita=i,this.responsabile=t,this.sedi=a,this.codResponsabilita=b[b.CAA],this.allegato=n},m=function e(i,t,a,n,o,r,s){_classCallCheck(this,e),this.idResponsabilita=i,this.codResponsabilita=b[b.LPC],this.ordine=t,this.iscrizione=a,this.cuaa=n,this.denominazione=o,this.rappresentante=r,this.allegato=s},v=function e(i,t,a,n,o,r){_classCallCheck(this,e),this.idResponsabilita=i,this.codResponsabilita=b[b.PAT],this.matricola=t,this.dirigente=a,this.dipartimento=n,this.allegato=o,this.note=r},S=function e(){_classCallCheck(this,e)},E=function e(i,t){_classCallCheck(this,e),this.cuaa=i,this.denominazione=t},T=t("/vOn"),A=t("cS1N"),C=t("69Tm"),y=t("RtSl"),R=t("arS9"),I=t("kPZZ"),O=t("A1Yd"),k=t("3Pt+"),z=t("+7Pr"),D=t("GLSp"),P=t("KDHY"),F=["upFileDistributor"];function L(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",21),n.Ob(1,"i",22),n.Tb(2,"h3"),n.Oc(3),n.Sb(),n.Tb(4,"p"),n.Oc(5),n.Sb(),n.Sb(),n.Tb(6,"div",0),n.Tb(7,"div",23),n.Tb(8,"button",24),n.bc("click",(function(){return n.Ec(t),n.fc().onConfirmHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Tb(9,"div",23),n.Tb(10,"button",25),n.bc("click",(function(){return n.Ec(t),n.fc().onRejectHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=i.$implicit,o=n.fc();n.Bb(3),n.Pc(a.summary),n.Bb(2),n.Pc(a.detail),n.Bb(3),n.mc("label",o.labels.si),n.Bb(2),n.mc("label",o.labels.no)}}function B(e,i){if(1&e&&(n.Tb(0,"div"),n.Oc(1),n.Sb()),2&e){var t=i.$implicit;n.Bb(1),n.Rc(" ",t.denominazioneAzienda," - ",t.comune," ")}}var M,_=((M=function(){function e(i,t){_classCallCheck(this,e),this.utentiService=i,this.messageService=t,this.labels=C.a,this.submitted=!1,this.availableDistributors=[],this.selectedDistributors=[],this.selectedIds=[],this.canUpload=!1,this.icon="ui-icon-file-upload",this.fileExt=".PDF",this.maxSize=2,this.uploadOk=!1}return _createClass(e,[{key:"isValid",get:function(){return this.selectedDistributors.length&&this.responsabile&&this.uploadValid}},{key:"orderedAvailableDistributors",get:function(){return this.availableDistributors?this.availableDistributors.sort((function(e,i){return(e.denominazioneAzienda+e.comune).localeCompare(i.denominazioneAzienda+i.comune)})):[]}},{key:"orderedSelectedDistributors",get:function(){return this.selectedDistributors?this.selectedDistributors.sort((function(e,i){return(e.denominazioneAzienda+e.comune).localeCompare(i.denominazioneAzienda+i.comune)})):[]}},{key:"ngOnInit",value:function(){var e=this;this.utentiService.getDistributori().subscribe((function(i){i&&i.length&&(i=i.sort((function(e,i){return(e.denominazioneAzienda+e.comune).localeCompare(i.denominazioneAzienda+i.comune)})),e.availableDistributors=i,e.syncDistributors(e.selectedIds))}))}},{key:"syncDistributors",value:function(e){e&&(this.selectedDistributors=this.availableDistributors.filter((function(i){return e.includes(i.id)})),this.availableDistributors=this.availableDistributors.filter((function(i){return!e.includes(i.id)})))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"downloadFile",value:function(){var e=this;this.utentiService.getPdfAutorizzazioneAltriEnti().subscribe((function(i){var t=new Blob([i],{}),a="AutorizzazioneDistributore_"+Date.now()+".pdf";o.saveAs(t,a),e.canUpload=!0}),(function(e){alert("Errore in scarico Pdf")}),(function(){}))}},{key:"uploadFile",value:function(e){var i=this;if(e.target.files&&e.target.files.length>0){var t=e.target.files[0],a=new A.a(this.fileExt,this.maxSize);a.isValidFile(t)?(this.fileAutorizzazione=t,this.utentiService.readByteFile(t).then((function(e){i.fileAutorizzazione=e,i.uploadValid=!0,i.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}),(function(e){i.handleError(e),i.uploadValid=!1})),this.uploadOk=!0):a.errors.forEach((function(e,t){i.messageService.add({key:"tst",severity:"error",summary:"Errore!",detail:e,life:s.a.TOAST_LIFE})})),this.icon="ui-icon-done",this.fileInput.nativeElement.value=""}}},{key:"verifyUploadFile",value:function(){this.uploadOk?this.showWarnAlreadyUploadedFile():document.getElementById("upFileDistributor").click()}},{key:"showWarnAlreadyUploadedFile",value:function(){this.messageService.add(s.a.getToast("warn-already-uploadedFile-distributor",s.b.warn,s.a.FILE_ALREADY_UPLOADED))}},{key:"onRejectHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-distributor")}},{key:"onConfirmHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-distributor"),document.getElementById("upFileDistributor").click()}},{key:"handleError",value:function(e){this.messageService.add(e&&e.error&&500===e.status?{key:"tst",severity:"error",summary:"Errore!",detail:e.error,life:s.a.TOAST_LIFE}:{key:"tst",severity:"error",summary:"Errore!",detail:"Errore generico",life:s.a.TOAST_LIFE})}},{key:"onSubmit",value:function(e){this.submitted=!0,this.messageService.add(e.invalid?s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI):s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setSelectedIds",value:function(e){this.selectedIds=e}}]),e}()).\u0275fac=function(e){return new(e||M)(n.Nb(T.a),n.Nb(y.d))},M.\u0275cmp=n.Hb({type:M,selectors:[["app-distributore"]],viewQuery:function(e,i){var t;1&e&&n.Uc(F,!0),2&e&&n.Ac(t=n.cc())&&(i.fileInput=t.first)},decls:38,vars:23,consts:[[1,"ui-g","ui-fluid"],["position","center","key","warn-already-uploadedFile-distributor",3,"modal","baseZIndex"],["pTemplate","messageService"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close",1,"remove-btn",3,"title","click"],[3,"ngSubmit"],["f","ngForm"],[3,"disabled"],[1,"ui-g","form-group"],[1,"ui-g-12","ui-md-12","ui-lg-12"],[3,"source","target","dragdrop","responsive"],["pTemplate","item"],[1,"ui-g-12","ui-md-6","ui-lg-6"],["type","text","name","responsabile","pInputText","","required","",3,"ngModel","ngModelChange"],[1,"ui-g-12","ui-md-12"],["pButton","","type","button","icon","ui-icon-file-download",3,"label","click"],["pButton","","type","button",3,"icon","label","disabled","click"],["type","file","id","upFileDistributor","name","upFileDistributor","multiple","false",2,"display","none",3,"accept","change"],["upFileDistributor",""],["align","justify"],[2,"text-align","center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3em"],[1,"ui-g-6"],["type","button","pButton","",1,"ui-button-success",3,"label","click"],["type","button","pButton","",1,"ui-button-secondary",3,"label","click"]],template:function(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",0),n.Tb(1,"p-toast",1),n.Mc(2,L,11,4,"ng-template",2),n.Sb(),n.Tb(3,"div",3),n.Tb(4,"p-panel",4),n.Tb(5,"p-header"),n.Oc(6),n.Tb(7,"button",5),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(8,"form",6,7),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(9);return i.onSubmit(e)})),n.Tb(10,"fieldset",8),n.Tb(11,"div",9),n.Tb(12,"div",10),n.Tb(13,"label"),n.Oc(14),n.Sb(),n.Tb(15,"p-pickList",11),n.Mc(16,B,2,2,"ng-template",12),n.Sb(),n.Sb(),n.Tb(17,"div",13),n.Tb(18,"label"),n.Oc(19),n.Sb(),n.Tb(20,"input",14),n.bc("ngModelChange",(function(e){return i.responsabile=e})),n.Sb(),n.Sb(),n.Tb(21,"div",13),n.Tb(22,"div",15),n.Tb(23,"label"),n.Oc(24),n.Sb(),n.Tb(25,"button",16),n.bc("click",(function(){return i.downloadFile()})),n.Sb(),n.Tb(26,"button",17),n.bc("click",(function(){return i.verifyUploadFile()})),n.Sb(),n.Tb(27,"input",18,19),n.bc("change",(function(e){return i.uploadFile(e)})),n.Sb(),n.Sb(),n.Sb(),n.Tb(29,"div"),n.Tb(30,"p-fieldset",20),n.Tb(31,"p-header"),n.Oc(32),n.Sb(),n.Oc(33),n.Ob(34,"br"),n.Oc(35),n.Ob(36,"br"),n.Oc(37),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}2&e&&(n.Bb(1),n.mc("modal",!0)("baseZIndex",5e3),n.Bb(3),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(1),n.mc("title",i.labels.delete),n.Bb(3),n.mc("disabled",i.disabled),n.Bb(4),n.Qc("",i.labels.distributorTitle," *"),n.Bb(1),n.mc("source",i.orderedAvailableDistributors)("target",i.orderedSelectedDistributors)("dragdrop",!i.disabled)("responsive",!0),n.Bb(4),n.Qc("",i.labels.responsabile," *"),n.Bb(1),n.mc("ngModel",i.responsabile),n.Bb(4),n.Pc(i.labels.authorization),n.Bb(1),n.mc("label",i.labels.downloadAuthorization),n.Bb(1),n.nc("icon",i.icon),n.mc("label",i.labels.uploadAuthorization)("disabled",!i.responsabile),n.Bb(1),n.nc("accept",i.fileExt),n.Bb(5),n.Pc(i.labels.warning),n.Bb(1),n.Qc(" ",i.labels.distributorFirstWarning," "),n.Bb(2),n.Qc(" ",i.labels.distributorSecondWarning," "),n.Bb(2),n.Qc(" ",i.labels.distributorThirdWarning," "))},directives:[R.a,y.e,I.a,y.c,O.b,k.I,k.t,k.u,z.a,k.c,D.a,k.D,k.s,k.v,P.a],styles:["[_nghost-%COMP%]     .ui-picklist li.ui-picklist-item{padding:0 .5rem}[_nghost-%COMP%]     .ui-picklist-source-controls.ui-picklist-buttons, [_nghost-%COMP%]     .ui-picklist-target-controls.ui-picklist-buttons{display:none}[_nghost-%COMP%]     .ui-picklist{display:block}"]}),M),U=t("sYmb"),N=["upFileALTRI"];function w(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",22),n.Ob(1,"i",23),n.Tb(2,"h3"),n.Oc(3),n.Sb(),n.Tb(4,"p"),n.Oc(5),n.Sb(),n.Sb(),n.Tb(6,"div",0),n.Tb(7,"div",24),n.Tb(8,"button",25),n.bc("click",(function(){return n.Ec(t),n.fc().onConfirmHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Tb(9,"div",24),n.Tb(10,"button",26),n.bc("click",(function(){return n.Ec(t),n.fc().onRejectHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=i.$implicit;n.Bb(3),n.Pc(a.summary),n.Bb(2),n.Pc(a.detail)}}var x,V=((x=function(){function e(i,t){_classCallCheck(this,e),this.utentiService=i,this.messageService=t,this.fileExt=".PDF",this.maxSize=2,this.uploadOk=!1,this.icon="ui-icon-file-upload"}return _createClass(e,[{key:"ngOnInit",value:function(){this.isValid=!1,this.canUpload=!1,this.submitted=!1}},{key:"downloadFile",value:function(){var e=this;this.utentiService.getPdfAutorizzazioneAltriEnti().subscribe((function(i){var t=new Blob([i],{}),a="AutorizzazioneAltriEnti_"+Date.now()+".pdf";o.saveAs(t,a),e.canUpload=!0}),(function(e){alert("Errore in scarico Pdf")}),(function(){}))}},{key:"uploadFile",value:function(e){var i=this;if(console.log("ChangeFile"),e.target.files&&e.target.files.length>0){var t=e.target.files[0];console.log("FileName "+t.name),console.log(t);var a=new A.a(this.fileExt,this.maxSize);console.log("FileSize "+a.getFileSize(t)),a.isValidFile(t)?(console.log("SubmitFile"),this.fileAutorizzazione=t,this.utentiService.readByteFile(t).then((function(e){i.fileAutorizzazione=e,console.log("Upload ok "+e),i.isValid=!0,i.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}),(function(e){i.handleError(e),i.isValid=!1})),this.uploadOk=!0):(console.log("File non valido"),a.errors.forEach((function(e,t){i.messageService.add({key:"tst",severity:"error",summary:"Errore!",detail:e,life:s.a.TOAST_LIFE})}))),this.icon="ui-icon-done",this.fileInput.nativeElement.value=""}}},{key:"verifyUploadFile",value:function(){this.uploadOk?this.showWarnAlreadyUploadedFile():document.getElementById("upFileALTRI").click()}},{key:"showWarnAlreadyUploadedFile",value:function(){this.messageService.add(s.a.getToast("warn-already-uploadedFile-altriEnti",s.b.warn,s.a.FILE_ALREADY_UPLOADED))}},{key:"onRejectHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-altriEnti")}},{key:"onConfirmHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-altriEnti"),document.getElementById("upFileALTRI").click()}},{key:"handleError",value:function(e){console.log("Error "+e+" msg "+e.error+" error.code "+e.status),this.messageService.add(e&&e.error&&500===e.status?{key:"tst",severity:"error",summary:"Errore!",detail:e.error,life:s.a.TOAST_LIFE}:{key:"tst",severity:"error",summary:"Errore!",detail:"Errore generico",life:s.a.TOAST_LIFE})}},{key:"onSubmit",value:function(e){console.log("this.onSubmit"),this.submitted=!0,e.invalid?this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI)):(this.isValid=!0,this.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"setDisabled",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||x)(n.Nb(T.a),n.Nb(y.d))},x.\u0275cmp=n.Hb({type:x,selectors:[["app-altri-enti"]],viewQuery:function(e,i){var t;1&e&&n.Jc(N,!0),2&e&&n.Ac(t=n.cc())&&(i.fileInput=t.first)},decls:52,vars:14,consts:[[1,"ui-g","ui-fluid"],["position","center","key","warn-already-uploadedFile-altriEnti",3,"modal","baseZIndex"],["pTemplate","messageService"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close","title","Elimina",1,"remove-btn",3,"click"],[3,"ngSubmit"],["f","ngForm"],[1,"ui-g-2"],[1,"ui-g-4"],["type","text","name","denominazione","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","piva","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","dirigente","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","note","required","","pInputText","",3,"ngModel","ngModelChange"],[1,"ui-g-12","ui-md-6","ui-lg-6"],[1,"ui-g-12","ui-md-12"],["pButton","","type","button","icon","ui-icon-file-download","label","Scarica Modello Autorizzazione",3,"click"],["pButton","","type","button","label","Carica Autorizzazione Firmata",3,"icon","disabled","click"],["type","file","id","upFileALTRI","name","upFileALTRI","multiple","false",2,"display","none",3,"accept","change"],["upFileALTRI",""],[1,"ui-g-12"],["align","justify"],[2,"text-align","center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3em"],[1,"ui-g-6"],["type","button","pButton","","label","Si",1,"ui-button-success",3,"click"],["type","button","pButton","","label","No",1,"ui-button-secondary",3,"click"]],template:function(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",0),n.Tb(1,"p-toast",1),n.Mc(2,w,11,2,"ng-template",2),n.Sb(),n.Tb(3,"div",3),n.Tb(4,"p-panel",4),n.Tb(5,"p-header"),n.Oc(6),n.Tb(7,"button",5),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(8,"form",6,7),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(9);return i.onSubmit(e)})),n.Tb(10,"fieldset"),n.Tb(11,"div"),n.Tb(12,"div",8),n.Tb(13,"label"),n.Oc(14,"Denominazione Ente *"),n.Sb(),n.Sb(),n.Tb(15,"div",9),n.Tb(16,"input",10),n.bc("ngModelChange",(function(e){return i.denominazione=e})),n.Sb(),n.Sb(),n.Tb(17,"div",8),n.Tb(18,"label"),n.Oc(19,"Partita IVA *"),n.Sb(),n.Sb(),n.Tb(20,"div",9),n.Tb(21,"input",11),n.bc("ngModelChange",(function(e){return i.piva=e})),n.Sb(),n.Sb(),n.Tb(22,"div",8),n.Tb(23,"label"),n.Oc(24,"Responsabile *"),n.Sb(),n.Sb(),n.Tb(25,"div",9),n.Tb(26,"input",12),n.bc("ngModelChange",(function(e){return i.dirigente=e})),n.Sb(),n.Sb(),n.Tb(27,"div",8),n.Tb(28,"label"),n.Oc(29),n.gc(30,"translate"),n.Sb(),n.Sb(),n.Tb(31,"div",9),n.Tb(32,"input",13),n.bc("ngModelChange",(function(e){return i.note=e})),n.Sb(),n.Sb(),n.Tb(33,"div",14),n.Tb(34,"div",15),n.Tb(35,"label"),n.Oc(36,"Autorizzazione"),n.Sb(),n.Tb(37,"button",16),n.bc("click",(function(){return i.downloadFile()})),n.Sb(),n.Tb(38,"button",17),n.bc("click",(function(){return i.verifyUploadFile()})),n.Sb(),n.Tb(39,"input",18,19),n.bc("change",(function(e){return i.uploadFile(e)})),n.Sb(),n.Sb(),n.Sb(),n.Tb(41,"div",20),n.Tb(42,"p-fieldset",21),n.Tb(43,"p-header"),n.Oc(44,"Attenzione"),n.Sb(),n.Oc(45," Digitare la denominazione dell'Ente di appartenenza, la partita IVA e il nominativo del Responsabile che autorizza la richiesta. "),n.Ob(46,"br"),n.Oc(47," Scaricare e compilare il modulo per l'autorizzazione (premere il pulsante Scarica Modello Autorizzazione). "),n.Ob(48,"br"),n.Oc(49," Importare tale documento firmato dal Responsabile con allegato, in formato PDF, il documento d'identit\xe0 dello stesso (premere il pulsante Carica Autorizzazione Firmata). "),n.Ob(50,"br"),n.Oc(51," Digitare il campo Motivazione della richiesta. "),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}2&e&&(n.Bb(1),n.mc("modal",!0)("baseZIndex",5e3),n.Bb(3),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(10),n.mc("ngModel",i.denominazione),n.Bb(5),n.mc("ngModel",i.piva),n.Bb(5),n.mc("ngModel",i.dirigente),n.Bb(3),n.Qc(" ",n.hc(30,12,"RICHIESTE_ACCESSO.motivazioneRichiesta")," * "),n.Bb(3),n.mc("ngModel",i.note),n.Bb(6),n.nc("icon",i.icon),n.mc("disabled",!(i.denominazione&&i.piva&&i.dirigente)),n.Bb(1),n.nc("accept",i.fileExt))},directives:[R.a,y.e,I.a,y.c,O.b,k.I,k.t,k.u,k.c,k.D,D.a,k.s,k.v,P.a],pipes:[U.d],styles:[""]}),x),H=t("GFTO"),Z=t("ofXK"),G=t("AD9J"),q=["upFileCAA"];function Q(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",20),n.Ob(1,"i",21),n.Tb(2,"h3"),n.Oc(3),n.Sb(),n.Tb(4,"p"),n.Oc(5),n.Sb(),n.Sb(),n.Tb(6,"div",0),n.Tb(7,"div",22),n.Tb(8,"button",23),n.bc("click",(function(){return n.Ec(t),n.fc().onConfirmHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Tb(9,"div",22),n.Tb(10,"button",24),n.bc("click",(function(){return n.Ec(t),n.fc().onRejectHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=i.$implicit;n.Bb(3),n.Pc(a.summary),n.Bb(2),n.Pc(a.detail)}}var K=function(){return{width:"100%",height:"300px",overflow:"auto",display:"block"}};function j(e,i){if(1&e){var t=n.Ub();n.Tb(0,"p-tree",25),n.bc("selectionChange",(function(e){return n.Ec(t),n.fc().selectedNodes=e})),n.Sb()}if(2&e){var a=n.fc();n.Kc(n.rc(4,K)),n.mc("value",a.entiCaaTreeNode)("selection",a.selectedNodes)}}var W,J=((W=function(){function e(i,t){_classCallCheck(this,e),this.utentiService=i,this.messageService=t,this.icon="ui-icon-file-upload",this.fileExt=".PDF",this.maxSize=2,this.uploadOk=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.isValid=!1,this.submitted=!1,this.canUpload=!1,this.utentiService.getUfficiCaa().subscribe((function(i){e.entiCaaTreeNode=H.a.getTreeNodes(i),e.parentNodes=e.selectEntiParent(e.entiCaaTreeNode),e.disableParent(),e.selectedNodes=H.a.selectEntiSedi(e.entiCaaTreeNode,e.entiSediSelectedIds)}))}},{key:"selectEntiParent",value:function(e){var i=[];return e.forEach((function(e,t){i.push(e)})),i}},{key:"disableParent",value:function(){this.parentNodes&&this.parentNodes.forEach((function(e){e.parent||(e.selectable=!1)}))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"downloadFile",value:function(){var e=this;this.utentiService.getPdfAutorizzazioneAltriEnti().subscribe((function(i){var t=new Blob([i],{}),a="AutorizzazioneCaa_"+Date.now()+".pdf";o.saveAs(t,a),e.canUpload=!0}),(function(e){alert("Errore in scarico Pdf")}),(function(){}))}},{key:"uploadFile",value:function(e){var i=this;if(console.log("ChangeFile"),e.target.files&&e.target.files.length>0){var t=e.target.files[0];console.log("FileName "+t.name),console.log(t);var a=new A.a(this.fileExt,this.maxSize);console.log("FileSize "+a.getFileSize(t)),a.isValidFile(t)?(console.log("SubmitFile"),this.fileAutorizzazione=t,this.utentiService.readByteFile(t).then((function(e){i.fileAutorizzazione=e,console.log("Upload ok "+e),i.isValid=!0,i.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}),(function(e){i.handleError(e),i.isValid=!1})),this.uploadOk=!0):(console.log("File non valido"),a.errors.forEach((function(e,t){i.messageService.add({key:"tst",severity:"error",summary:"Errore!",detail:e,life:s.a.TOAST_LIFE})}))),this.icon="ui-icon-done",this.fileInput.nativeElement.value=""}}},{key:"verifyUploadFile",value:function(){this.uploadOk?this.showWarnAlreadyUploadedFile():document.getElementById("upFileCAA").click()}},{key:"showWarnAlreadyUploadedFile",value:function(){this.messageService.add(s.a.getToast("warn-already-uploadedFile-caa",s.b.warn,s.a.FILE_ALREADY_UPLOADED))}},{key:"onRejectHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-caa")}},{key:"onConfirmHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-caa"),document.getElementById("upFileCAA").click()}},{key:"handleError",value:function(e){console.log("Error "+e+" msg "+e.error+" error.code "+e.status),this.messageService.add(e&&e.error&&500===e.status?{key:"tst",severity:"error",summary:"Errore!",detail:e.error,life:s.a.TOAST_LIFE}:{key:"tst",severity:"error",summary:"Errore!",detail:"Errore generico",life:s.a.TOAST_LIFE})}},{key:"onSubmit",value:function(e){console.log("this.onSubmit"),this.submitted=!0,e.invalid?this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI)):(this.isValid=!0,this.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)))}},{key:"enableAll",value:function(e){var i=this;console.log("enableAll: "+e),this.entiCaaTreeNode&&this.entiCaaTreeNode.forEach((function(t){i.enableRecursive(t,e)}))}},{key:"enableRecursive",value:function(e,i){var t=this;e.selectable=i,e.children&&e.children.forEach((function(e){t.enableRecursive(e,i)}))}},{key:"setDisabled",value:function(e){this.disabled=e,this.enableAll(!e)}},{key:"setSelectedIds",value:function(e){this.entiSediSelectedIds=e}}]),e}()).\u0275fac=function(e){return new(e||W)(n.Nb(T.a),n.Nb(y.d))},W.\u0275cmp=n.Hb({type:W,selectors:[["app-caa"]],viewQuery:function(e,i){var t;1&e&&n.Jc(q,!0),2&e&&n.Ac(t=n.cc())&&(i.fileInput=t.first)},decls:38,vars:10,consts:[[1,"ui-g","ui-fluid"],["position","center","key","warn-already-uploadedFile-caa",3,"modal","baseZIndex"],["pTemplate","messageService"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close","title","Elimina",1,"remove-btn",3,"click"],[3,"ngSubmit"],["f","ngForm"],[3,"disabled"],[1,"ui-g","form-group"],[1,"ui-g-12","ui-md-6","ui-lg-6"],["for","enti"],["selectionMode","checkbox",3,"style","value","selection","selectionChange",4,"ngIf"],["type","text","name","responsabile","pInputText","","required","",3,"ngModel","ngModelChange"],[1,"ui-g-12","ui-md-12"],["pButton","","type","button","icon","ui-icon-file-download","label","Scarica Modello Autorizzazione",3,"click"],["pButton","","type","button","label","Carica Autorizzazione Firmata",3,"icon","disabled","click"],["type","file","id","upFileCAA","name","upFileCAA","multiple","false",2,"display","none",3,"accept","change"],["upFileCAA",""],["align","justify"],[2,"text-align","center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3em"],[1,"ui-g-6"],["type","button","pButton","","label","Si",1,"ui-button-success",3,"click"],["type","button","pButton","","label","No",1,"ui-button-secondary",3,"click"],["selectionMode","checkbox",3,"value","selection","selectionChange"]],template:function(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",0),n.Tb(1,"p-toast",1),n.Mc(2,Q,11,2,"ng-template",2),n.Sb(),n.Tb(3,"div",3),n.Tb(4,"p-panel",4),n.Tb(5,"p-header"),n.Oc(6),n.Tb(7,"button",5),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(8,"form",6,7),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(9);return i.onSubmit(e)})),n.Tb(10,"fieldset",8),n.Tb(11,"div",9),n.Tb(12,"div",10),n.Tb(13,"label",11),n.Oc(14,"Caa/Sedi *"),n.Sb(),n.Mc(15,j,1,5,"p-tree",12),n.Sb(),n.Tb(16,"div",10),n.Tb(17,"label"),n.Oc(18,"Responsabile *"),n.Sb(),n.Tb(19,"input",13),n.bc("ngModelChange",(function(e){return i.responsabile=e})),n.Sb(),n.Tb(20,"div",14),n.Tb(21,"label"),n.Oc(22,"Autorizzazione"),n.Sb(),n.Tb(23,"button",15),n.bc("click",(function(){return i.downloadFile()})),n.Sb(),n.Tb(24,"button",16),n.bc("click",(function(){return i.verifyUploadFile()})),n.Sb(),n.Tb(25,"input",17,18),n.bc("change",(function(e){return i.uploadFile(e)})),n.Sb(),n.Sb(),n.Sb(),n.Tb(27,"div"),n.Tb(28,"p-fieldset",19),n.Tb(29,"p-header"),n.Oc(30,"Attenzione"),n.Sb(),n.Oc(31," Selezionare > per visualizzare l'elenco delle sedi del CAA e scegliere la voce desiderata. "),n.Ob(32,"br"),n.Oc(33," Digitare il nominativo del Responsabile della struttura. "),n.Ob(34,"br"),n.Oc(35," Scaricare e compilare il modulo per l'autorizzazione (premere il pulsante Scarica Modello Autorizzazione). "),n.Ob(36,"br"),n.Oc(37," Importare tale documento firmato dal Responsabile con allegato, in formato PDF, il documento d'identit\xe0 dello stesso (premere il pulsante Carica Autorizzazione Firmata) "),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}2&e&&(n.Bb(1),n.mc("modal",!0)("baseZIndex",5e3),n.Bb(3),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(4),n.mc("disabled",i.disabled),n.Bb(5),n.mc("ngIf",i.entiCaaTreeNode),n.Bb(4),n.mc("ngModel",i.responsabile),n.Bb(5),n.nc("icon",i.icon),n.mc("disabled",!(i.responsabile&&i.selectedNodes)),n.Bb(1),n.nc("accept",i.fileExt))},directives:[R.a,y.e,I.a,y.c,O.b,k.I,k.t,k.u,Z.t,k.c,D.a,k.D,k.s,k.v,P.a,G.a],styles:[""]}),W),Y=t("jLKh"),$=t("wH++"),X=t("tk/3"),ee=t("c8LR"),ie=["upFileLPC"];function te(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",31),n.Ob(1,"i",32),n.Tb(2,"h3"),n.Oc(3),n.Sb(),n.Tb(4,"p"),n.Oc(5),n.Sb(),n.Sb(),n.Tb(6,"div",0),n.Tb(7,"div",33),n.Tb(8,"button",34),n.bc("click",(function(){return n.Ec(t),n.fc().onConfirmHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Tb(9,"div",33),n.Tb(10,"button",35),n.bc("click",(function(){return n.Ec(t),n.fc().onRejectHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=i.$implicit;n.Bb(3),n.Pc(a.summary),n.Bb(2),n.Pc(a.detail)}}function ae(e,i){if(1&e&&(n.Tb(0,"p",37),n.Oc(1),n.Sb()),2&e){n.fc(2);var t=n.Bc(27);n.Bb(1),n.Qc(" ",t.errors.cuaaErratoCompleto," ")}}function ne(e,i){if(1&e&&(n.Tb(0,"div"),n.Mc(1,ae,2,1,"p",36),n.Sb()),2&e){n.fc();var t=n.Bc(27);n.Bb(1),n.mc("ngIf",null==t.errors?null:t.errors.cuaaErratoCompleto)}}function oe(e,i){if(1&e&&(n.Tb(0,"option",38),n.Oc(1),n.Sb()),2&e){var t=i.$implicit;n.mc("value",t.dati),n.Bb(1),n.Qc(" ",t.dati," ")}}var re,se=function(e){return{"is-invalid":e}},le=((re=function(){function e(i,t,a,n,o){_classCallCheck(this,e),this.utentiService=i,this.messageService=t,this._configuration=a,this.http=n,this.antimafiaService=o,this.fileExt=".PDF",this.maxSize=2,this.uploadOk=!1,this.icon="ui-icon-file-upload",this.codiciCaricheRappresentanteLegale=["ACR","ADP","AMD","AMG","AMM","AMP","AMS","APR","ART","ATI","AUN","AUP","CDP","CDT","CLR","CM","CMS","COA","COD","COG","COL","COM","COP","COV","COZ","CRT","CST","CUE","CUF","CUM","IN","LER","LGR","LGT","LI","LIG","LR2","LRF","LRT","LSA","MPP","OAS","OPN","PAD","PCA","PCD","PCE","PCG","PCO","PDC","PDI","PED","PEO","PG","PGD","PGE","PGS","PM","PPP","PRE","PRP","PRQ","PSE","PSS","PTE","RAF","RAP","RAS","RES","RFM","RIN","RIT","RSS","SAO","SAP","SCR","SFC","SLR","SOA","SOL","SOR","SOT","SOU","SPR","TI","TI2","TIT","TTE","TU","UM1","VPC"]}return _createClass(e,[{key:"ngOnInit",value:function(){this.isValid=!1,this.canUpload=!1,this.submitted=!1}},{key:"cuaachange",value:function(e){this.isValid&&(this.isValid=!1),this.submitted=!1,this.denominazione="",this.rappresentantiLegali=[]}},{key:"caricaRappresentantiLegali",value:function(e){var i=this;if(this.submitted=!0,e.invalid)this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI));else if(c.a.campoNonValorizzato(this.cuaa))this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI));else{c.a.validaCuaaIntero(this.cuaa,!0);var t=this._configuration.UrlGetAnagraficaImpresa.replace("${cuaa}",String(this.cuaa));this.http.get(t).subscribe((function(e){if("OK"===e.header.esito){var a=encodeURIComponent(JSON.stringify({numeroREASede:e.dati.listaimprese.estremiimpresa[0].datiiscrizionerea[0].nrea,provinciaSede:e.dati.listaimprese.estremiimpresa[0].datiiscrizionerea[0].cciaa}));t=i._configuration.UrlGetDettaglioCompletoImpresa+a,i.antimafiaService.rappresentatiLegali(t).subscribe((function(e){if(i.rappresentantiLegali=[],e.dati.datiimpresa.personesede.persona.forEach((function(e){e.personafisica&&e.cariche.carica.forEach((function(t){-1!==i.codiciCaricheRappresentanteLegale.indexOf(t.ccarica)&&i.rappresentantiLegali.push(new Y.a(e.personafisica.codicefiscale,e.personafisica.nome+" "+e.personafisica.cognome+" - "+t.descrizione))}))})),i.rappresentantiLegali&&i.rappresentantiLegali[0]){var t=i.rappresentantiLegali.find((function(e){return e.codiceFiscale===i.cuaa}));i.selectedCUAADD=t?t.dati:i.rappresentantiLegali[0].dati}i.denominazione=e.dati.datiimpresa.estremiimpresa.denominazione}),(function(e){console.log("Error",e),i.messageService.add(s.a.getToast("tst",s.b.error,"Errore in recupero rappresentanti: "+e.error.message))}))}else i.messageService.add(s.a.getToast("tst",s.b.error,"Errore in recupero rappresentanti: "+e.dati.errore.msgerr))}),(function(e){console.log("Error",e),i.messageService.add(s.a.getToast("tst",s.b.error,"Errore in recupero rappresentanti: "+e.error.message))}))}}},{key:"downloadFile",value:function(){var e=this;this.utentiService.getPdfAutorizzazioneConsulente().subscribe((function(i){var t=new Blob([i],{}),a="AutorizzazioneConsulente_"+Date.now()+".pdf";o.saveAs(t,a),e.canUpload=!0}),(function(e){alert("Errore in scarico Pdf")}),(function(){}))}},{key:"uploadFile",value:function(e){var i=this;if(this.rappresentante=this.selectedCUAADD,console.log("Rappresentante: "+this.rappresentante),console.log("ChangeFile"),e.target.files&&e.target.files.length>0){var t=e.target.files[0];console.log("FileName "+t.name),console.log(t);var a=new A.a(this.fileExt,this.maxSize);console.log("FileSize "+a.getFileSize(t)),a.isValidFile(t)?(console.log("SubmitFile"),this.fileAutorizzazione=t,this.utentiService.readByteFile(t).then((function(e){i.fileAutorizzazione=e,console.log("Upload ok "+e),i.isValid=!0,i.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}),(function(e){i.handleError(e),i.isValid=!1})),this.uploadOk=!0):(console.log("File non valido"),a.errors.forEach((function(e,t){i.messageService.add({key:"tst",severity:"error",summary:"Errore!",detail:e,life:s.a.TOAST_LIFE})}))),this.icon="ui-icon-done",this.fileInput.nativeElement.value=""}}},{key:"verifyUploadFile",value:function(){this.uploadOk?this.showWarnAlreadyUploadedFile():document.getElementById("upFileLPC").click()}},{key:"showWarnAlreadyUploadedFile",value:function(){this.messageService.add(s.a.getToast("warn-already-uploadedFile-consulente",s.b.warn,s.a.FILE_ALREADY_UPLOADED))}},{key:"onRejectHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-consulente")}},{key:"onConfirmHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-consulente"),document.getElementById("upFileLPC").click()}},{key:"handleError",value:function(e){console.log("Error "+e+" msg "+e.error+" error.code "+e.status),this.messageService.add(e&&e.error&&500===e.status?{key:"tst",severity:"error",summary:"Errore!",detail:e.error,life:s.a.TOAST_LIFE}:{key:"tst",severity:"error",summary:"Errore!",detail:"Errore generico",life:s.a.TOAST_LIFE})}},{key:"onSubmit",value:function(e){console.log("this.onSubmit"),this.submitted=!0,e.invalid?this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI)):(this.isValid=!0,this.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"setDisabled",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||re)(n.Nb(T.a),n.Nb(y.d),n.Nb(u.a),n.Nb(X.b),n.Nb($.a))},re.\u0275cmp=n.Hb({type:re,selectors:[["app-consulente"]],viewQuery:function(e,i){var t;1&e&&n.Jc(ie,!0),2&e&&n.Ac(t=n.cc())&&(i.fileInput=t.first)},decls:65,vars:23,consts:[[1,"ui-g","ui-fluid"],["position","center","key","warn-already-uploadedFile-consulente",3,"modal","baseZIndex"],["pTemplate","messageService"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close","title","Elimina",1,"remove-btn",3,"click"],[3,"ngSubmit"],["f","ngForm"],[1,"ui-g-2"],[1,"ui-g-4"],["type","text","name","ordine","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","iscrizione","required","","pInputText","",3,"ngModel","ngModelChange"],[1,"ui-g-12","ui-md-6","ui-lg-5"],[1,""],["type","text","name","cuaa","pInputText","","appValidaCuaaCompleto","",3,"ngModel","ngClass","readonly","ngModelChange","input"],["cuaaInput","ngModel"],[4,"ngIf"],[1,"ui-g-12","ui-md-6","ui-lg-2"],["pButton","","type","submit","label","Cerca",3,"disabled","click"],["type","text","name","denominazione","pInputText","","appValidadenominazione","",3,"ngModel","ngClass","readonly","ngModelChange"],["denominazioneInput","ngModel"],[1,"ui-g-12","ui-md-8"],["name","rappresentante",1,"custom-select",2,"height","47px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"ui-g-12","ui-md-6","ui-lg-6"],[1,"ui-g-12","ui-md-12"],["pButton","","type","button","icon","ui-icon-file-download","label","Scarica Modello Autorizzazione",3,"click"],["pButton","","type","button","label","Carica Autorizzazione Firmata",3,"icon","disabled","click"],["type","file","id","upFileLPC","name","upFileLPC","multiple","false",2,"display","none",3,"accept","change"],["upFileLPC",""],["align","justify"],[2,"text-align","center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3em"],[1,"ui-g-6"],["type","button","pButton","","label","Si",1,"ui-button-success",3,"click"],["type","button","pButton","","label","No",1,"ui-button-secondary",3,"click"],["class","ui-message ui-messages-error ui-corner-all",4,"ngIf"],[1,"ui-message","ui-messages-error","ui-corner-all"],[3,"value"]],template:function(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",0),n.Tb(1,"p-toast",1),n.Mc(2,te,11,2,"ng-template",2),n.Sb(),n.Tb(3,"div",3),n.Tb(4,"p-panel",4),n.Tb(5,"p-header"),n.Oc(6),n.Tb(7,"button",5),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(8,"form",6,7),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(9);return i.onSubmit(e)})),n.Tb(10,"fieldset"),n.Tb(11,"div"),n.Tb(12,"div",8),n.Tb(13,"label"),n.Oc(14,"Ordine di appartenenza *"),n.Sb(),n.Sb(),n.Tb(15,"div",9),n.Tb(16,"input",10),n.bc("ngModelChange",(function(e){return i.ordine=e})),n.Sb(),n.Sb(),n.Tb(17,"div",8),n.Tb(18,"label"),n.Oc(19,"Numero di Iscrizione *"),n.Sb(),n.Sb(),n.Tb(20,"div",9),n.Tb(21,"input",11),n.bc("ngModelChange",(function(e){return i.iscrizione=e})),n.Sb(),n.Sb(),n.Tb(22,"div",12),n.Tb(23,"span",13),n.Tb(24,"label"),n.Oc(25,"CUAA *"),n.Sb(),n.Tb(26,"input",14,15),n.bc("ngModelChange",(function(e){return i.cuaa=e}))("input",(function(e){return i.cuaachange(e)})),n.Sb(),n.Mc(28,ne,2,1,"div",16),n.Sb(),n.Sb(),n.Tb(29,"div",17),n.Ob(30,"br"),n.Tb(31,"button",18),n.bc("click",(function(){n.Ec(t);var e=n.Bc(9);return i.caricaRappresentantiLegali(e)})),n.Sb(),n.Sb(),n.Tb(32,"div",12),n.Tb(33,"span",13),n.Tb(34,"label"),n.Oc(35,"Descrizione Impresa"),n.Sb(),n.Tb(36,"input",19,20),n.bc("ngModelChange",(function(e){return i.denominazione=e})),n.Sb(),n.Sb(),n.Sb(),n.Tb(38,"div",8),n.Tb(39,"label"),n.Oc(40,"Rappresentante Legale *"),n.Sb(),n.Sb(),n.Tb(41,"div",21),n.Tb(42,"select",22),n.bc("ngModelChange",(function(e){return i.selectedCUAADD=e})),n.Mc(43,oe,2,2,"option",23),n.Sb(),n.Sb(),n.Tb(44,"div",24),n.Tb(45,"div",25),n.Tb(46,"label"),n.Oc(47,"Autorizzazione"),n.Sb(),n.Tb(48,"button",26),n.bc("click",(function(){return i.downloadFile()})),n.Sb(),n.Tb(49,"button",27),n.bc("click",(function(){return i.verifyUploadFile()})),n.Sb(),n.Tb(50,"input",28,29),n.bc("change",(function(e){return i.uploadFile(e)})),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Tb(52,"div"),n.Tb(53,"p-fieldset",30),n.Tb(54,"p-header"),n.Oc(55,"Attenzione"),n.Sb(),n.Oc(56," Digitare l'ordine di appartenenza e il numero di iscrizione. "),n.Ob(57,"br"),n.Oc(58," Digitare il CUAA relativo all'impresa per la quale si chiede il mandato (l'autorizzazione ad operare per conto dell\u2019azienda) e premere il pulsante Cerca. "),n.Ob(59,"br"),n.Oc(60," Digitare il Rappresentante Legale selezionandolo dalla lista. "),n.Ob(61,"br"),n.Oc(62," Scaricare e compilare il modulo per l'autorizzazione (premere il pulsante Scarica Modello Autorizzazione). "),n.Ob(63,"br"),n.Oc(64," Importare tale documento firmato dal Responsabile con allegato, in formato PDF, il documento d'identit\xe0 dello stesso (premere il pulsante Carica Autorizzazione Firmata) "),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=n.Bc(9),o=n.Bc(27),r=n.Bc(37);n.Bb(1),n.mc("modal",!0)("baseZIndex",5e3),n.Bb(3),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(10),n.mc("ngModel",i.ordine),n.Bb(5),n.mc("ngModel",i.iscrizione),n.Bb(5),n.mc("ngModel",i.cuaa)("ngClass",n.sc(19,se,o.invalid&&(o.touched||a.submitted)))("readonly",!(i.ordine&&i.iscrizione)),n.Bb(2),n.mc("ngIf",o.errors),n.Bb(3),n.mc("disabled",!a.valid||i.submitted||!i.cuaa),n.Bb(5),n.mc("ngModel",i.denominazione)("ngClass",n.sc(21,se,r.invalid))("readonly",!0),n.Bb(6),n.mc("ngModel",i.selectedCUAADD),n.Bb(1),n.mc("ngForOf",i.rappresentantiLegali),n.Bb(6),n.nc("icon",i.icon),n.mc("disabled",!(i.ordine&&i.iscrizione&&i.cuaa&&i.denominazione)),n.Bb(1),n.nc("accept",i.fileExt)}},directives:[R.a,y.e,I.a,y.c,O.b,k.I,k.t,k.u,k.c,k.D,D.a,k.s,k.v,ee.a,Z.q,Z.t,k.E,Z.s,P.a,k.x,k.H],styles:[""]}),re),ce=t("yWug");function ue(e,i){1&e&&(n.Tb(0,"tr"),n.Tb(1,"th"),n.Tb(2,"strong"),n.Oc(3),n.gc(4,"translate"),n.Sb(),n.Sb(),n.Tb(5,"th"),n.Tb(6,"strong"),n.Oc(7),n.gc(8,"translate"),n.Sb(),n.Sb(),n.Sb()),2&e&&(n.Bb(3),n.Pc(n.hc(4,2,"cuaa")),n.Bb(4),n.Pc(n.hc(8,4,"gestioneUtenze.descrizioneImpresa")))}function de(e,i){if(1&e&&(n.Tb(0,"tr"),n.Tb(1,"td"),n.Oc(2),n.Sb(),n.Tb(3,"td"),n.Oc(4),n.Sb(),n.Sb()),2&e){var t=i.$implicit;n.Bb(2),n.Pc(t.cuaa),n.Bb(2),n.Pc(t.denominazione)}}function be(e,i){if(1&e&&(n.Tb(0,"tr"),n.Tb(1,"td"),n.Oc(2),n.gc(3,"translate"),n.Sb(),n.Sb()),2&e){var t=n.fc();n.Bb(1),n.Cb("colspan",2),n.Bb(1),n.Rc(" ",n.hc(3,3,"NO_RESPONSABILITA")," ",t.cfPersona," ")}}var pe,fe=((pe=function(){function e(i){_classCallCheck(this,e),this.utentiService=i,this.isValid=!1,this.submitted=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;console.log("LegaleComponent cfPersona "+this.cfPersona),this.elencoCariche||this.utentiService.getListaCariche(this.cfPersona).subscribe((function(i){e.elencoCariche=i,e.elencoCariche&&(e.isValid=!0)}))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"addElencoResponsabilita",value:function(e){this.elencoCariche||(this.elencoCariche=[]),this.elencoCariche.push({codiceFiscale:null,cuaa:e.cuaa,denominazione:e.denominazione,carica:null})}}]),e}()).\u0275fac=function(e){return new(e||pe)(n.Nb(T.a))},pe.\u0275cmp=n.Hb({type:pe,selectors:[["app-legale"]],decls:17,vars:7,consts:[[1,"ui-g","ui-fluid"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close","title","Elimina",1,"remove-btn",3,"click"],[3,"disabled"],[1,"ui-g","form-group"],[3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"]],template:function(e,i){1&e&&(n.Tb(0,"div",0),n.Tb(1,"div",1),n.Tb(2,"p-panel",2),n.Tb(3,"p-header"),n.Oc(4),n.Tb(5,"button",3),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(6,"fieldset",4),n.Tb(7,"div",5),n.Tb(8,"strong"),n.Oc(9),n.gc(10,"translate"),n.Sb(),n.Ob(11,"br"),n.Ob(12,"br"),n.Tb(13,"p-table",6),n.Mc(14,ue,9,6,"ng-template",7),n.Mc(15,de,5,2,"ng-template",8),n.Mc(16,be,4,5,"ng-template",9),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()),2&e&&(n.Bb(2),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(2),n.mc("disabled",i.disabled),n.Bb(3),n.Pc(n.hc(10,5,"DATI_FASCICOLO_AZIENDALE")),n.Bb(4),n.mc("value",i.elencoCariche))},directives:[I.a,y.c,O.b,ce.q,y.e],pipes:[U.d],styles:[""]}),pe),he=t("3Kf3"),ge=["upFilePAT"];function me(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",22),n.Ob(1,"i",23),n.Tb(2,"h3"),n.Oc(3),n.Sb(),n.Tb(4,"p"),n.Oc(5),n.Sb(),n.Sb(),n.Tb(6,"div",0),n.Tb(7,"div",24),n.Tb(8,"button",25),n.bc("click",(function(){return n.Ec(t),n.fc().onConfirmHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Tb(9,"div",24),n.Tb(10,"button",26),n.bc("click",(function(){return n.Ec(t),n.fc().onRejectHasAlreadyUploadedFile()})),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=i.$implicit;n.Bb(3),n.Pc(a.summary),n.Bb(2),n.Pc(a.detail)}}var ve,Se=((ve=function(){function e(i,t){_classCallCheck(this,e),this.utentiService=i,this.messageService=t,this.icon="ui-icon-file-upload",this.uploadOk=!1,this.fileExt=".PDF",this.maxSize=2}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.isValid=!1,this.canUpload=!1,this.submitted=!1,this.dipartimentiPat=[],this.utentiService.getDipartimentiPat().subscribe((function(i){var t,a=_createForOfIteratorHelper(i);try{for(a.s();!(t=a.n()).done;){var n=t.value;e.dipartimentiPat.push(n)}}catch(o){a.e(o)}finally{a.f()}}),(function(i){s.a.handleError(e.messageService,i,s.a.ERRORE_RESPONSABILITA),e.isValid=!1}))}},{key:"filterDipartimentoSingle",value:function(e){var i=e.query;console.log(e.query),this.filteredDipartimentiSingle=this.filterDipartimento(i,this.dipartimentiPat)}},{key:"filterDipartimento",value:function(e,i){for(var t=[],a=0;a<i.length;a++){var n=i[a];n.toLowerCase().indexOf(e.toLowerCase())>=0&&t.push(n)}return t}},{key:"downloadFile",value:function(){var e=this;this.utentiService.getPdfAutorizzazioneUtentePAT().subscribe((function(i){var t=new Blob([i],{}),a="AutorizzazioneUtentePAT_"+Date.now()+".pdf";o.saveAs(t,a),e.canUpload=!0}),(function(e){alert("Errore in scarico Pdf")}),(function(){}))}},{key:"uploadFile",value:function(e){var i=this;if(console.log("ChangeFile"),e.target.files&&e.target.files.length>0){var t=e.target.files[0];console.log("FileName "+t.name),console.log(t);var a=new A.a(this.fileExt,this.maxSize);console.log("FileSize "+a.getFileSize(t)),a.isValidFile(t)?(console.log("SubmitFile"),this.fileAutorizzazione=t,this.utentiService.readByteFile(t).then((function(e){i.fileAutorizzazione=e,console.log("Upload ok "+e),i.isValid=!0,i.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}),(function(e){i.handleError(e),i.isValid=!1})),this.uploadOk=!0):(console.log("File non valido"),a.errors.forEach((function(e,t){i.messageService.add({key:"tst",severity:"error",summary:"Errore!",detail:e,life:s.a.TOAST_LIFE})}))),this.icon="ui-icon-done",this.fileInput.nativeElement.value=""}}},{key:"verifyUploadFile",value:function(){this.uploadOk?this.showWarnAlreadyUploadedFile():document.getElementById("upFilePAT").click()}},{key:"showWarnAlreadyUploadedFile",value:function(){this.messageService.add(s.a.getToast("warn-already-uploadedFile-pat",s.b.warn,s.a.FILE_ALREADY_UPLOADED))}},{key:"onRejectHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-pat")}},{key:"onConfirmHasAlreadyUploadedFile",value:function(){this.messageService.clear("warn-already-uploadedFile-pat"),document.getElementById("upFilePAT").click()}},{key:"handleError",value:function(e){console.log("Error "+e+" msg "+e.error+" error.code "+e.status),this.messageService.add(e&&e.error&&500===e.status?{key:"tst",severity:"error",summary:"Errore!",detail:e.error,life:s.a.TOAST_LIFE}:{key:"tst",severity:"error",summary:"Errore!",detail:"Errore generico",life:s.a.TOAST_LIFE})}},{key:"onSubmit",value:function(e){console.log("this.onSubmit"),this.submitted=!0,e.invalid?this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI)):(this.isValid=!0,this.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"setDisabled",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||ve)(n.Nb(T.a),n.Nb(y.d))},ve.\u0275cmp=n.Hb({type:ve,selectors:[["app-pat"]],viewQuery:function(e,i){var t;1&e&&n.Jc(ge,!0),2&e&&n.Ac(t=n.cc())&&(i.fileInput=t.first)},decls:52,vars:19,consts:[[1,"ui-g","ui-fluid"],["position","center","key","warn-already-uploadedFile-pat",3,"modal","baseZIndex"],["pTemplate","messageService"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close","title","Elimina",1,"remove-btn",3,"click"],[3,"ngSubmit"],["f","ngForm"],[1,"ui-g-2"],[1,"ui-g-4"],["type","text","name","matricola","required","","pInputText","",3,"ngModel","ngModelChange"],["name","dipartimento","emptyMessage","--Nessun Dipartimento trovato--",3,"ngModel","suggestions","size","minLength","forceSelection","required","ngModelChange","completeMethod"],["type","text","name","dirigente","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","note","required","","pInputText","",3,"ngModel","ngModelChange"],[1,"ui-g-12","ui-md-6","ui-lg-6"],[1,"ui-g-12","ui-md-12"],["pButton","","type","button","icon","ui-icon-file-download","label","Scarica Modello Autorizzazione",3,"click"],["pButton","","type","button","label","Carica Autorizzazione Firmata",3,"icon","disabled","click"],["type","file","id","upFilePAT","name","upFilePAT",2,"display","none",3,"accept","change"],["upFilePAT",""],[1,"ui-g-12"],["align","justify"],[2,"text-align","center"],[1,"pi","pi-exclamation-triangle",2,"font-size","3em"],[1,"ui-g-6"],["type","button","pButton","","label","Si",1,"ui-button-success",3,"click"],["type","button","pButton","","label","No",1,"ui-button-secondary",3,"click"]],template:function(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",0),n.Tb(1,"p-toast",1),n.Mc(2,me,11,2,"ng-template",2),n.Sb(),n.Tb(3,"div",3),n.Tb(4,"p-panel",4),n.Tb(5,"p-header"),n.Oc(6),n.Tb(7,"button",5),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(8,"form",6,7),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(9);return i.onSubmit(e)})),n.Tb(10,"fieldset"),n.Tb(11,"div"),n.Tb(12,"div",8),n.Tb(13,"label"),n.Oc(14,"Matricola *"),n.Sb(),n.Sb(),n.Tb(15,"div",9),n.Tb(16,"input",10),n.bc("ngModelChange",(function(e){return i.matricola=e})),n.Sb(),n.Sb(),n.Tb(17,"div",8),n.Tb(18,"label"),n.Oc(19,"Struttura *"),n.Sb(),n.Sb(),n.Tb(20,"div",9),n.Tb(21,"p-autoComplete",11),n.bc("ngModelChange",(function(e){return i.dipartimento=e}))("completeMethod",(function(e){return i.filterDipartimentoSingle(e)})),n.Sb(),n.Sb(),n.Tb(22,"div",8),n.Tb(23,"label"),n.Oc(24,"Dirigente *"),n.Sb(),n.Sb(),n.Tb(25,"div",9),n.Tb(26,"input",12),n.bc("ngModelChange",(function(e){return i.dirigente=e})),n.Sb(),n.Sb(),n.Tb(27,"div",8),n.Tb(28,"label"),n.Oc(29),n.gc(30,"translate"),n.Sb(),n.Sb(),n.Tb(31,"div",9),n.Tb(32,"input",13),n.bc("ngModelChange",(function(e){return i.note=e})),n.Sb(),n.Sb(),n.Tb(33,"div",14),n.Tb(34,"div",15),n.Tb(35,"label"),n.Oc(36,"Autorizzazione"),n.Sb(),n.Tb(37,"button",16),n.bc("click",(function(){return i.downloadFile()})),n.Sb(),n.Tb(38,"button",17),n.bc("click",(function(){return i.verifyUploadFile()})),n.Sb(),n.Tb(39,"input",18,19),n.bc("change",(function(e){return i.uploadFile(e)})),n.Sb(),n.Sb(),n.Sb(),n.Tb(41,"div",20),n.Tb(42,"p-fieldset",21),n.Tb(43,"p-header"),n.Oc(44,"Attenzione"),n.Sb(),n.Oc(45," Digitare la struttura di appartenenza selezionandola dalla lista e il nominativo del Responsabile della stessa. "),n.Ob(46,"br"),n.Oc(47," Scaricare e compilare il modulo per l'autorizzazione (premere il pulsante Scarica Modello Autorizzazione). "),n.Ob(48,"br"),n.Oc(49," Importare tale documento firmato dal Responsabile con allegato, in formato PDF, il documento d'identit\xe0 dello stesso (premere il pulsante Carica Autorizzazione Firmata). "),n.Ob(50,"br"),n.Oc(51," Digitare il campo Motivazione della richiesta. "),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}2&e&&(n.Bb(1),n.mc("modal",!0)("baseZIndex",5e3),n.Bb(3),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(10),n.mc("ngModel",i.matricola),n.Bb(5),n.mc("ngModel",i.dipartimento)("suggestions",i.filteredDipartimentiSingle)("size",30)("minLength",1)("forceSelection",!0)("required",!0),n.Bb(5),n.mc("ngModel",i.dirigente),n.Bb(3),n.Qc(" ",n.hc(30,17,"RICHIESTE_ACCESSO.motivazioneRichiesta")," * "),n.Bb(3),n.mc("ngModel",i.note),n.Bb(6),n.nc("icon",i.icon),n.mc("disabled",!(i.matricola&&i.dirigente)),n.Bb(1),n.nc("accept",i.fileExt))},directives:[R.a,y.e,I.a,y.c,O.b,k.I,k.t,k.u,k.c,k.D,D.a,k.s,k.v,he.a,P.a],pipes:[U.d],styles:[""]}),ve);function Ee(e,i){if(1&e&&(n.Tb(0,"p",18),n.Oc(1),n.Sb()),2&e){n.fc(2);var t=n.Bc(15);n.Bb(1),n.Qc(" ",t.errors.cuaaErratoCompleto," ")}}function Te(e,i){if(1&e&&(n.Tb(0,"div"),n.Mc(1,Ee,2,1,"p",17),n.Sb()),2&e){n.fc();var t=n.Bc(15);n.Bb(1),n.mc("ngIf",null==t.errors?null:t.errors.cuaaErratoCompleto)}}var Ae,Ce=function(e){return{"is-invalid":e}},ye=((Ae=function(){function e(i,t){_classCallCheck(this,e),this.utentiService=i,this.messageService=t}return _createClass(e,[{key:"ngOnInit",value:function(){console.log("TitolareComponent cfPersona "+this.cfPersona),this.isValid=!1,this.submitted=!1}},{key:"cuaachange",value:function(e){this.denominazione="",this.isValid&&(this.isValid=!1),this.submitted=!1}},{key:"onSubmit",value:function(e){var i=this;this.submitted=!0,e.invalid||c.a.campoNonValorizzato(this.cuaa)?this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI)):(c.a.validaCuaaIntero(this.cuaa,!0),this.utentiService.checkFascicoloValido(this.cuaa).subscribe((function(e){console.log("Fascicolo valido "+e),i.checkRappresentante()}),(function(e){s.a.handleError(i.messageService,e,s.a.ERRORE_GENERICO),i.isValid=!1})))}},{key:"checkRappresentante",value:function(){var e=this;this.utentiService.getAziendaRappresentata(this.cuaa,this.cfPersona).subscribe((function(i){console.log("Rappresentante ok "+i),e.isValid=!0,e.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)),e.denominazione=i.mvalue}),(function(i){s.a.handleError(e.messageService,i,s.a.ERRORE_GENERICO),e.isValid=!1}))}},{key:"removeMe",value:function(){this.compInteraction.remove(this.index)}},{key:"setDisabled",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||Ae)(n.Nb(T.a),n.Nb(y.d))},Ae.\u0275cmp=n.Hb({type:Ae,selectors:[["app-titolare"]],decls:26,vars:14,consts:[[1,"ui-g","ui-fluid"],[1,"ui-g-12","ui-lg-12"],[3,"toggleable"],["pButton","","type","button","icon","ui-icon-close","title","Elimina",1,"remove-btn",3,"click"],[3,"ngSubmit"],["f","ngForm"],[3,"disabled"],[1,"ui-g","form-group"],[1,"ui-g-12","ui-md-6","ui-lg-5"],[1,""],["type","text","name","cuaa","pInputText","","appValidaCuaaCompleto","",3,"ngModel","ngClass","ngModelChange","input"],["cuaaInput","ngModel"],[4,"ngIf"],[1,"ui-g-12","ui-md-6","ui-lg-2"],["pButton","","type","submit","label","Cerca",3,"disabled"],["type","text","name","denominazione","pInputText","","appValidadenominazione","",3,"ngModel","ngClass","readonly","ngModelChange"],["denominazioneInput","ngModel"],["class","ui-message ui-messages-error ui-corner-all",4,"ngIf"],[1,"ui-message","ui-messages-error","ui-corner-all"]],template:function(e,i){if(1&e){var t=n.Ub();n.Tb(0,"div",0),n.Tb(1,"div",1),n.Tb(2,"p-panel",2),n.Tb(3,"p-header"),n.Oc(4),n.Tb(5,"button",3),n.bc("click",(function(){return i.removeMe()})),n.Sb(),n.Sb(),n.Tb(6,"form",4,5),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(7);return i.onSubmit(e)})),n.Tb(8,"fieldset",6),n.Tb(9,"div",7),n.Tb(10,"div",8),n.Tb(11,"span",9),n.Tb(12,"label"),n.Oc(13,"CUAA *"),n.Sb(),n.Tb(14,"input",10,11),n.bc("ngModelChange",(function(e){return i.cuaa=e}))("input",(function(e){return i.cuaachange(e)})),n.Sb(),n.Mc(16,Te,2,1,"div",12),n.Sb(),n.Sb(),n.Tb(17,"div",13),n.Ob(18,"br"),n.Ob(19,"button",14),n.Sb(),n.Tb(20,"div",8),n.Tb(21,"span",9),n.Tb(22,"label"),n.Oc(23,"Descrizione Impresa"),n.Sb(),n.Tb(24,"input",15,16),n.bc("ngModelChange",(function(e){return i.denominazione=e})),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=n.Bc(7),o=n.Bc(15),r=n.Bc(25);n.Bb(2),n.mc("toggleable",!0),n.Bb(2),n.Qc(" ",i.title," "),n.Bb(4),n.mc("disabled",i.disabled),n.Bb(6),n.mc("ngModel",i.cuaa)("ngClass",n.sc(10,Ce,o.invalid&&(o.touched||a.submitted))),n.Bb(2),n.mc("ngIf",o.errors),n.Bb(3),n.mc("disabled",!a.valid||i.submitted),n.Bb(5),n.mc("ngModel",i.denominazione)("ngClass",n.sc(12,Ce,r.invalid))("readonly",!0)}},directives:[I.a,y.c,O.b,k.I,k.t,k.u,k.c,D.a,ee.a,k.s,k.v,Z.q,Z.t],styles:[""]}),Ae),Re=function e(i,t,a,n){_classCallCheck(this,e),this.idResponsabilita=i,this.responsabile=t,this.distributori=a,this.codResponsabilita=b[b.DIPENDENTE_DISTRIBUTORE],this.allegato=n},Ie=t("yhG/"),Oe=t("x5p7"),ke=t("+WeO"),ze=t("IWUw"),De=t("dS4e"),Pe=t("1SSY"),Fe=t("T8KO"),Le=t("KwdP"),Be=["viewContainerRef"];function Me(e,i){if(1&e&&(n.Tb(0,"p",51),n.Oc(1),n.Sb()),2&e){n.fc(2);var t=n.Bc(22);n.Bb(1),n.Qc(" ",t.errors.cfErrato," ")}}function _e(e,i){if(1&e&&(n.Tb(0,"div"),n.Mc(1,Me,2,1,"p",50),n.Sb()),2&e){n.fc();var t=n.Bc(22);n.Bb(1),n.mc("ngIf",null==t.errors?null:t.errors.cfErrato)}}function Ue(e,i){if(1&e&&(n.Tb(0,"p",51),n.Oc(1),n.Sb()),2&e){n.fc(2);var t=n.Bc(29);n.Bb(1),n.Qc(" ",t.errors.emailErrata," ")}}function Ne(e,i){if(1&e&&(n.Tb(0,"div"),n.Mc(1,Ue,2,1,"p",50),n.Sb()),2&e){n.fc();var t=n.Bc(29);n.Bb(1),n.mc("ngIf",null==t.errors?null:t.errors.emailErrata)}}function we(e,i){if(1&e&&(n.Tb(0,"p",51),n.Oc(1),n.Sb()),2&e){n.fc(2);var t=n.Bc(37);n.Bb(1),n.Qc(" ",t.errors.telefonoErrato," ")}}function xe(e,i){if(1&e&&(n.Tb(0,"div"),n.Mc(1,we,2,1,"p",50),n.Sb()),2&e){n.fc();var t=n.Bc(37);n.Bb(1),n.mc("ngIf",null==t.errors?null:t.errors.telefonoErrato)}}function Ve(e,i){}var He=function(e){return{"is-invalid":e}};function Ze(e,i){if(1&e){var t=n.Ub();n.Tb(0,"form",18,19),n.bc("ngSubmit",(function(){n.Ec(t);var e=n.Bc(1);return n.fc().onSubmit(e)})),n.Tb(2,"div",9),n.Tb(3,"p-accordion"),n.Tb(4,"p-accordionTab",20),n.Tb(5,"fieldset",21),n.Tb(6,"div",22),n.Tb(7,"div",23),n.Tb(8,"label"),n.Oc(9,"Cognome *"),n.Sb(),n.Sb(),n.Tb(10,"div",24),n.Tb(11,"input",25),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().datiAnagraficiUtente.cognome=e})),n.Sb(),n.Sb(),n.Tb(12,"div",23),n.Tb(13,"label"),n.Oc(14,"Nome *"),n.Sb(),n.Sb(),n.Tb(15,"div",24),n.Tb(16,"input",26),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().datiAnagraficiUtente.nome=e})),n.Sb(),n.Sb(),n.Tb(17,"div",23),n.Tb(18,"label"),n.Oc(19,"C.F. *"),n.Sb(),n.Sb(),n.Tb(20,"div",24),n.Tb(21,"input",27,28),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().datiAnagraficiUtente.codiceFiscale=e})),n.Sb(),n.Mc(23,_e,2,1,"div",29),n.Sb(),n.Tb(24,"div",23),n.Tb(25,"label"),n.Oc(26,"Email/PEC *"),n.Sb(),n.Sb(),n.Tb(27,"div",24),n.Tb(28,"input",30,31),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().datiAnagraficiUtente.email=e})),n.Sb(),n.Mc(30,Ne,2,1,"div",29),n.Sb(),n.Ob(31,"div",5),n.Tb(32,"div",23),n.Tb(33,"label"),n.Oc(34,"Telefono *"),n.Sb(),n.Sb(),n.Tb(35,"div",24),n.Tb(36,"input",32,33),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().datiAnagraficiUtente.telefono=e})),n.Sb(),n.Mc(38,xe,2,1,"div",29),n.Sb(),n.Ob(39,"div",34),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Tb(40,"div",9),n.Tb(41,"p-accordion"),n.Tb(42,"p-accordionTab",35),n.Tb(43,"div",36),n.Tb(44,"fieldset",8),n.Tb(45,"div",37),n.Tb(46,"p-dropdown",38),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().selectedResponsabilita=e})),n.Sb(),n.Sb(),n.Tb(47,"div",39),n.Tb(48,"button",40),n.bc("click",(function(){return n.Ec(t),n.fc().addComponent()})),n.Sb(),n.Sb(),n.Tb(49,"div",5),n.Mc(50,Ve,0,0,"ng-template",null,41,n.Nc),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Tb(52,"div",9),n.Tb(53,"p-accordion"),n.Tb(54,"p-accordionTab",42),n.Tb(55,"div",43),n.Tb(56,"p-multiSelect",44),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().selectedApplicativi=e})),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Ob(57,"div",45),n.Tb(58,"div",23),n.Tb(59,"div",46),n.Tb(60,"button",47),n.bc("click",(function(){return n.Ec(t),n.fc().modificaStatoRichiesta()})),n.Sb(),n.Sb(),n.Sb(),n.Tb(61,"div",23),n.Tb(62,"div",48),n.Ob(63,"button",49),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=n.Bc(1),o=n.Bc(22),r=n.Bc(29),s=n.Bc(37),l=n.fc();n.Bb(4),n.mc("selected",!0),n.Bb(1),n.mc("disabled",l.inserimentoDisabled),n.Bb(6),n.mc("ngModel",l.datiAnagraficiUtente.cognome),n.Bb(5),n.mc("ngModel",l.datiAnagraficiUtente.nome),n.Bb(5),n.mc("ngModel",l.datiAnagraficiUtente.codiceFiscale)("readonly",l.cfReadonly||!l.canChangeCf)("ngClass",n.sc(26,He,o.invalid)),n.Bb(2),n.mc("ngIf",o.errors),n.Bb(5),n.mc("ngModel",l.datiAnagraficiUtente.email),n.Bb(2),n.mc("ngIf",r.errors),n.Bb(6),n.mc("ngModel",l.datiAnagraficiUtente.telefono),n.Bb(2),n.mc("ngIf",s.errors),n.Bb(4),n.mc("selected",!0),n.Bb(2),n.mc("disabled",l.inserimentoDisabled),n.Bb(2),n.mc("options",l.responsabilitaList)("ngModel",l.selectedResponsabilita)("disabled",l.inserimentoDisabled),n.Bb(2),n.nc("title",l.datiAnagraficiUtente.codiceFiscale?"Aggiungi Responsabilit\xe0":"Inserire un C.F. per continuare"),n.mc("disabled",!l.datiAnagraficiUtente.codiceFiscale),n.Bb(6),n.mc("selected",!0),n.Bb(2),n.mc("filter",!1)("options",l.applicativi)("ngModel",l.selectedApplicativi)("disabled",l.inserimentoDisabled),n.Bb(4),n.mc("disabled",!l.inserimentoDisabled),n.Bb(3),n.mc("disabled",!a.valid||l.responsabilitaNonValide||l.inserimentoDisabled)}}function Ge(e,i){if(1&e){var t=n.Ub();n.Tb(0,"a",52),n.bc("click",(function(){return n.Ec(t),n.fc(2).downloadModuloRichiestaAccesso()})),n.Oc(1," Modulo richiesta accesso "),n.Sb()}}function qe(e,i){1&e&&(n.Tb(0,"span"),n.Oc(1,"Modulo richiesta accesso"),n.Sb())}function Qe(e,i){if(1&e){var t=n.Ub();n.Tb(0,"tr"),n.Tb(1,"th"),n.Tb(2,"b"),n.Oc(3,"VISUALIZZAZIONE"),n.Sb(),n.Sb(),n.Tb(4,"th"),n.Tb(5,"b"),n.Oc(6,"FIRMA ACCETTAZIONE"),n.Sb(),n.Sb(),n.Sb(),n.Tb(7,"tr"),n.Tb(8,"th"),n.Tb(9,"a",52),n.bc("click",(function(){return n.Ec(t),n.fc().downloadInformativaPrivacy()})),n.Oc(10," Informativa Privacy "),n.Sb(),n.Sb(),n.Tb(11,"th"),n.Tb(12,"p-inputSwitch",53),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().checked1=e}))("onChange",(function(e){return n.Ec(t),n.fc().sottoScriviPrivacyCheck(e)})),n.Sb(),n.Sb(),n.Sb(),n.Tb(13,"tr"),n.Tb(14,"th"),n.Mc(15,Ge,2,0,"a",54),n.Mc(16,qe,2,0,"span",29),n.Sb(),n.Tb(17,"th"),n.Tb(18,"p-inputSwitch",55),n.bc("ngModelChange",(function(e){return n.Ec(t),n.fc().checked2=e}))("onChange",(function(e){return n.Ec(t),n.fc().sottoScriviDomandaCheck(e)})),n.Sb(),n.Sb(),n.Sb()}if(2&e){var a=n.fc();n.Bb(12),n.mc("ngModel",a.checked1)("disabled",!a.informativaPrivacyFile)("disabled",!(a.datiDomanda.autorizzazioni&&a.datiDomanda.autorizzazioni.length>0)&&!a.viewPrivacy||a.datiDomanda.autorizzazioni&&a.datiDomanda.autorizzazioni.length>0||!a.inserimentoDisabled||a.blockCheckPrivacyOk),n.Bb(3),n.mc("ngIf",a.saveOk),n.Bb(1),n.mc("ngIf",!a.saveOk),n.Bb(2),n.mc("ngModel",a.checked2)("disabled",a.checked2||!a.viewModuloDomanda)}}var Ke,je,We,Je=function(){return{marginTop:"70px"}},Ye=((Ke=function(){function e(i,t,a,n,o,r,s,l,c){_classCallCheck(this,e),this.loader=i,this.utentiService=t,this.CFR=a,this.messageService=n,this._configuration=o,this.http=r,this.messages=s,this.configuration=l,this.translateService=c,this.cfReadonly=!1,this.inserimentoDisabled=!1,this.viewPrivacy=!1,this.viewModuloDomanda=!1,this.checked1=!1,this.checked2=!1,this.saveOk=!1,this.blockCheckPrivacyOk=!1,this.canProtocol=!0,this.hasPrivacyProtocollata=!1,this.index=0,this.componentsReferences=[],this.controlliDatiAnagrafici=[],this.legaleRappresentanteErrorList=[],this.caaErrorList=[],this.patErrorList=[],this.altriEntiErrorList=[],this.consulenteErrorList=[],this.distributoreErrorList=[],this.blobToFile=function(e,i){var t=e;return t.lastModifiedDate=new Date,t.name=i,e}}return _createClass(e,[{key:"ngOnInit",value:function(){this.datiDomanda=new f,this.loader.setTimeout(48e4),this.setServizi(),this.setResponsabilitaList(),this.setControlliDatiAnagrafici(),this.canAdd=!1,this.canChangeCf=!0,this.responsabilitaNonValide=!0,this.idRichiesta||this.caricaDatiAnagrafici()}},{key:"getProfiliUtenteConnesso",value:function(){var e=this;this.utentiService.getProfiliUtenteConnesso().subscribe((function(i){i&&i.some((function(e){return"TITOLARE_AZIENDA_AGRICOLA"===e.responsabilita}))&&e.aggiungiResponsabilitaTitolareLegaleRappresentante()}))}},{key:"aggiungiResponsabilitaTitolareLegaleRappresentante",value:function(){var e;if(this.datiAnagraficiUtente&&c.a.validaCuaaIntero(this.datiAnagraficiUtente.codiceFiscale,!1)){e=this.datiAnagraficiUtente.codiceFiscale;var i=this.CFR.resolveComponentFactory(fe);this.createComponent(i).cfPersona=e}}},{key:"setControlliDatiAnagrafici",value:function(){this.controlliDatiAnagrafici=[],this.controlliDatiAnagrafici.push("cognome"),this.controlliDatiAnagrafici.push("nome"),this.controlliDatiAnagrafici.push("codiceFiscale"),this.controlliDatiAnagrafici.push("email"),this.controlliDatiAnagrafici.push("telefono")}},{key:"setServizi",value:function(){this.applicativi=[{label:"SRT",title:"SRTrento - Misure strutturali"},{label:"A4G",title:"A4G - Nuovo Sistema Informativo Agricoltura"},{label:"AGS",title:"SIAP - Sistema Informativo Agricoltura"}]}},{key:"setResponsabilitaList",value:function(){this.responsabilitaList=[],this.responsabilitaList.push({label:this.translateService.instant("gestioneUtenze.TI_LR"),value:{id:2,name:this.translateService.instant("gestioneUtenze.TI_LR"),code:b.LR}}),this.responsabilitaList.push({label:"Libero professionista/Consulente",value:{id:3,name:"Libero professionista/Consulente",code:b.LPC}}),this.responsabilitaList.push({label:"Dipendente/Collaboratore PAT",value:{id:4,name:"Dipendente/Collaboratore PAT",code:b.PAT}}),this.responsabilitaList.push({label:"Dipendente/Collaboratore CAA",value:{id:5,name:"Dipendente/Collaboratore CAA",code:b.CAA}}),this.responsabilitaList.push({label:"Dipendente/Collaboratore Altri Enti",value:{id:6,name:"Dipendente/Collaboratore Altri Enti",code:b.ALTRI}}),this.responsabilitaList.push({label:"Dipendente/Collaboratore Distributore",value:{id:7,name:"Dipendente/Collaboratore Distributore",code:b.DIPENDENTE_DISTRIBUTORE}}),this.selectedResponsabilita=this.responsabilitaList[0].value}},{key:"ngOnDestroy",value:function(){this.loader.resetTimeout()}},{key:"caricaDatiAnagrafici",value:function(){var e=this;this.utentiService.getDatiAnagraficiUtente().subscribe((function(i){e.datiAnagraficiUtente=i,e.cfReadonly=null!=e.datiAnagraficiUtente.codiceFiscale&&e.datiAnagraficiUtente.codiceFiscale.length>0,e.datiAnagraficiUtente&&c.a.validaCuaaIntero(e.datiAnagraficiUtente.codiceFiscale,!1)&&(e.canAdd=!0),e.verificaPrivacy(e.datiAnagraficiUtente.codiceFiscale),e.getProfiliUtenteConnesso(),e.recuperaDomandaApprovata(e.datiAnagraficiUtente.codiceFiscale)}))}},{key:"recuperaDomandaApprovata",value:function(e){var i=this;this.utentiService.getUltimaDomandaUtenteCorrente("APPROVATA",p.COMPLETA).subscribe((function(e){e&&(console.log("Result recuperaDomandaApprovata: ",e),i.datiAnagraficiUtente=e.datiAnagrafici,i.selectedApplicativi=[],e.servizi.forEach((function(e){var t=i.applicativi.find((function(i){return i.label===e}));i.selectedApplicativi.push(t)})),e.responsabilitaRichieste.responsabilitaAltriEnti&&e.responsabilitaRichieste.responsabilitaAltriEnti.forEach((function(e){return i.aggiungiResponsabilitaAltriEnti(e)})),e.responsabilitaRichieste.responsabilitaCaa&&e.responsabilitaRichieste.responsabilitaCaa.forEach((function(e){return i.aggiungiResponsabilitaCAA(e)})),e.responsabilitaRichieste.responsabilitaConsulente&&e.responsabilitaRichieste.responsabilitaConsulente.forEach((function(e){return i.aggiungiResponsabilitaConsulente(e)})),e.responsabilitaRichieste.responsabilitaPat&&e.responsabilitaRichieste.responsabilitaPat.forEach((function(e){return i.aggiungiResponsabilitaPat(e)})),e.responsabilitaRichieste.responsabilitaDistributore&&e.responsabilitaRichieste.responsabilitaDistributore.forEach((function(e){return i.aggiungiResponsabilitaDistributore(e)})))}))}},{key:"aggiungiResponsabilitaAltriEnti",value:function(e){var i=this.CFR.resolveComponentFactory(V),t=this.createComponent(i);t.title="Dipendente/Collaboratore Altri Enti",t.codeResponsabilita=b.ALTRI,t.denominazione=e.denominazione,t.piva=e.piva,t.dirigente=e.dirigente,t.note=e.note,this.responsabilitaNonValide=!1}},{key:"aggiungiResponsabilitaCAA",value:function(e){var i=this.CFR.resolveComponentFactory(J),t=this.createComponent(i);t.title="Dipendente / Collaboratore CAA",t.codeResponsabilita=b.CAA,t.responsabile=e.responsabile;var a=[];e.sedi.forEach((function(e){return a.push(e.identificativo)})),t.setSelectedIds(a),this.responsabilitaNonValide=!1}},{key:"aggiungiResponsabilitaConsulente",value:function(e){var i=this.CFR.resolveComponentFactory(le),t=this.createComponent(i);t.title="Libero professionista/Consulente",t.codeResponsabilita=b.LPC,t.ordine=e.ordine,t.iscrizione=e.iscrizione,t.cuaa=e.cuaa,this.responsabilitaNonValide=!1}},{key:"aggiungiResponsabilitaLegaleRappresentante",value:function(e){var i=this.datiAnagraficiUtente.codiceFiscale,t=this.CFR.resolveComponentFactory(fe),a=this.createComponent(t);a.cfPersona=i,a.title=this.translateService.instant("gestioneUtenze.TI_LR"),a.codeResponsabilita=b.LR,e.forEach((function(e){return a.addElencoResponsabilita(e)})),this.responsabilitaNonValide=!1}},{key:"aggiungiResponsabilitaTitolare",value:function(e){var i=this.datiAnagraficiUtente.codiceFiscale,t=this.CFR.resolveComponentFactory(fe),a=this.createComponent(t);a.cfPersona=i,a.title=this.translateService.instant("gestioneUtenze.TI_LR"),a.codeResponsabilita=b.TI,a.addElencoResponsabilita(e),this.responsabilitaNonValide=!1}},{key:"aggiungiResponsabilitaPat",value:function(e){var i=this.CFR.resolveComponentFactory(Se),t=this.createComponent(i);t.title="Dipendente/Collaboratore PAT",t.codeResponsabilita=b.PAT,t.matricola=e.matricola,t.dipartimento=e.dipartimento,t.dirigente=e.dirigente,t.note=e.note,this.responsabilitaNonValide=!1}},{key:"aggiungiResponsabilitaDistributore",value:function(e){var i=this.CFR.resolveComponentFactory(_),t=this.createComponent(i);t.title="Dipendente / Collaboratore Distributore",t.codeResponsabilita=b.DIPENDENTE_DISTRIBUTORE,t.responsabile=e.responsabile;var a=[];e.distributori.forEach((function(e){return a.push(e.id)})),t.setSelectedIds(a),this.responsabilitaNonValide=!1}},{key:"verificaPrivacy",value:function(e){var i=this;this.utentiService.ricercaPersone({codiceFiscale:e}).subscribe((function(e){e&&e.length>0&&e[0]&&(console.log(e[0]),i.persona=e[0],i.datiDomanda.autorizzazioni=e[0].nrProtocolloPrivacyGenerale,i.datiDomanda.autorizzazioni&&i.datiDomanda.autorizzazioni.length>0&&(i.viewPrivacy=!0,i.checked1=!0,i.hasPrivacyProtocollata=!0))}),(function(e){console.error("Errore in ricercaPersone: "+e),i.messages.add(s.a.getToast("generic",s.b.error,"Errore in recupero Persona: "+e.error.message))}))}},{key:"addComponent",value:function(){if(this.componentsReferences&&this.componentsReferences.length>0&&this.componentsReferences.filter((function(e){return!e.instance.isValid})).length>0)return this.messageService.add(s.a.getToast("tst",s.b.error,"Per aggiungere un\u2019altra responsabilit\xe0 \xe8 necessario completare la responsabilit\xe0 precedentemente aggiunta o eliminarla"));var e;if(this.datiAnagraficiUtente&&c.a.validaCuaaIntero(this.datiAnagraficiUtente.codiceFiscale,!1)){switch(e=this.datiAnagraficiUtente.codiceFiscale,this.selectedResponsabilita.code){case b.TI:var i=this.CFR.resolveComponentFactory(ye),t=this.createComponent(i);t.cfPersona=e,t.cuaa=e,t.isValid||(t.removeMe(!0),this.messageService.add(s.a.getToast("tst",s.b.error,this.translateService.instant("NO_RESPONSABILITA")+e)));break;case b.LR:if(this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita==b.LR})).length>0){this.messageService.add(s.a.getToast("tst",s.b.error,s.a.responsabilitaPresente));break}var a=this.CFR.resolveComponentFactory(fe);this.createComponent(a).cfPersona=e;break;case b.LPC:var n=this.CFR.resolveComponentFactory(le);this.createComponent(n);break;case b.PAT:var o=this.CFR.resolveComponentFactory(Se);this.createComponent(o);break;case b.CAA:var r=this.CFR.resolveComponentFactory(J);this.createComponent(r);break;case b.ALTRI:var l=this.CFR.resolveComponentFactory(V);this.createComponent(l);break;case b.DIPENDENTE_DISTRIBUTORE:var u=this.CFR.resolveComponentFactory(_);this.createComponent(u)}this.canChangeCf=!1,this.checkEsisteResponsbilita()}}},{key:"createComponent",value:function(e){var i=this.VCR.createComponent(e,0),t=i.instance;return t.selfRef=t,t.index=++this.index,t.title=this.selectedResponsabilita.name,t.codeResponsabilita=this.selectedResponsabilita.code,t.setDisabled(this.inserimentoDisabled),t.compInteraction=this,this.componentsReferences.unshift(i),t}},{key:"remove",value:function(e){if(!(this.VCR.length<=0)){var i=this.componentsReferences.filter((function(i){return i.instance.index===e}))[0];i&&(i.destroy(),this.componentsReferences=this.componentsReferences.filter((function(i){return i.instance.index!==e})),this.VCR.length<=0&&(this.canChangeCf=!0),this.checkEsisteResponsbilita())}}},{key:"checkEsisteResponsbilita",value:function(){this.responsabilitaNonValide=!this.componentsReferences||0===this.componentsReferences.length,console.log("responsabilitaNonValide "+this.responsabilitaNonValide)}},{key:"modificaStatoRichiesta",value:function(){var e=this;this.inserimentoDisabled=!this.inserimentoDisabled,this.saveOk=!1,this.viewModuloDomanda=!1,this.checked2=!1,this.checked1&&(this.blockCheckPrivacyOk=!0),this.componentsReferences.forEach((function(i,t){i.instance.setDisabled(e.inserimentoDisabled)}))}},{key:"enableRecursive",value:function(e,i){var t=this;e.selectable=i,e.children&&e.children.forEach((function(e){t.enableRecursive(e,i)}))}},{key:"onSubmit",value:function(e){if(console.log("Salva"),this.messageService.clear(),e.invalid){if(console.log(e),!this.checkDatiAnagrafici(e)||!this.checkProfiliRichiesti(e))return;this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI))}else this.checkResponsabilita()&&(this.datiDomanda.datiAnagrafici=this.datiAnagraficiUtente,this.datiDomanda.servizi=this.popolaApplicativi(),this.datiDomanda.responsabilitaRichieste=this.popolaResponsabilita(),this.datiDomanda.tipoDomandaRegistrazione=p.COMPLETA,console.log(this.datiDomanda.responsabilitaRichieste),this.legaleRappresentanteErrorList=[],this.caaErrorList=[],this.patErrorList=[],this.altriEntiErrorList=[],this.consulenteErrorList=[],this.distributoreErrorList=[],this.datiDomanda.responsabilitaRichieste.responsabilitaLegaleRappresentante&&this.verificaValiditaLegaleRappresentante(),this.datiDomanda.responsabilitaRichieste.responsabilitaCaa&&this.verificaValiditaCaa(),this.datiDomanda.responsabilitaRichieste.responsabilitaPat&&this.verificaValiditaPat(),this.datiDomanda.responsabilitaRichieste.responsabilitaAltriEnti&&this.verificaValiditaAltriEnti(),this.datiDomanda.responsabilitaRichieste.responsabilitaConsulente&&this.verificaValiditaConsulente(),this.datiDomanda.responsabilitaRichieste.responsabilitaDistributore&&this.verificaValiditaDistributore(),this.verificaAssenzaErrorListResponsabilita()&&(this.datiDomanda.responsabilitaRichieste.responsabilitaAltriEnti&&this.datiDomanda.responsabilitaRichieste.responsabilitaAltriEnti.length>0||this.datiDomanda.responsabilitaRichieste.responsabilitaCaa&&this.datiDomanda.responsabilitaRichieste.responsabilitaCaa.length>0||this.datiDomanda.responsabilitaRichieste.responsabilitaConsulente&&this.datiDomanda.responsabilitaRichieste.responsabilitaConsulente.length>0||this.datiDomanda.responsabilitaRichieste.responsabilitaLegaleRappresentante&&this.datiDomanda.responsabilitaRichieste.responsabilitaLegaleRappresentante.length>0||this.datiDomanda.responsabilitaRichieste.responsabilitaPat&&this.datiDomanda.responsabilitaRichieste.responsabilitaPat.length>0||this.datiDomanda.responsabilitaRichieste.responsabilitaTitolare&&this.datiDomanda.responsabilitaRichieste.responsabilitaTitolare.length>0||this.datiDomanda.responsabilitaRichieste.responsabilitaDistributore&&this.datiDomanda.responsabilitaRichieste.responsabilitaDistributore.length>0)?(null==this.datiDomanda.id?this.inserisci():this.aggiorna(),this.rimuoviAllegati()):this.messageService.add(s.a.getToast("tst",s.b.error,"La sezione Responsabilit\xe0 non \xe8 compilata correttamente")))}},{key:"verificaAssenzaErrorListResponsabilita",value:function(){return 0===this.caaErrorList.length&&0===this.patErrorList.length&&0===this.altriEntiErrorList.length&&0===this.consulenteErrorList.length&&0===this.legaleRappresentanteErrorList.length&&0===this.distributoreErrorList.length}},{key:"verificaValiditaConsulente",value:function(){var e=this;this.datiDomanda.responsabilitaRichieste.responsabilitaConsulente.forEach((function(i){i.ordine||e.consulenteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.ORDINE_APPARTENENZA"))||e.consulenteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.ORDINE_APPARTENENZA")),i.iscrizione||e.consulenteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.NUMERO_ISCRIZIONE"))||e.consulenteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.NUMERO_ISCRIZIONE")),i.cuaa||e.consulenteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.CUAA"))||e.consulenteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.CUAA")),i.denominazione||e.consulenteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.DESC_IMPRESA"))||e.consulenteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.DESC_IMPRESA")),i.rappresentante||e.consulenteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.RAPP_LEGALE"))||e.consulenteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.RAPP_LEGALE")),i.allegato||e.consulenteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))||e.consulenteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))})),this.consulenteErrorList.length>0&&this.messageService.add(s.a.getToast("tst",s.b.error,'Per la responabilit\xe0 "Libero professionista/Consulente" non sono stati compilati i campi: '+this.consulenteErrorList.toString()))}},{key:"verificaValiditaAltriEnti",value:function(){var e=this;this.datiDomanda.responsabilitaRichieste.responsabilitaAltriEnti.forEach((function(i){i.denominazione||e.altriEntiErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.DENOMINAZIONE_ENTE"))||e.altriEntiErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.DENOMINAZIONE_ENTE")),i.piva||e.altriEntiErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.PARTITA_IVA"))||e.altriEntiErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.PARTITA_IVA")),i.dirigente||e.altriEntiErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.RESPONSABILE"))||e.altriEntiErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.RESPONSABILE")),i.note||e.altriEntiErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.motivazioneRichiesta"))||e.altriEntiErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.motivazioneRichiesta")),i.allegato||e.altriEntiErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))||e.altriEntiErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))})),this.altriEntiErrorList.length>0&&this.messageService.add(s.a.getToast("tst",s.b.error,'Per la responabilit\xe0 "Dipendente/Collaboratore Altri Enti" non sono stati compilati i campi: '+this.altriEntiErrorList.toString()))}},{key:"verificaValiditaPat",value:function(){var e=this;this.datiDomanda.responsabilitaRichieste.responsabilitaPat.forEach((function(i){i.matricola||e.patErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.MATRICOLA"))||e.patErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.MATRICOLA")),i.dirigente||e.patErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.DIRIGENTE"))||e.patErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.DIRIGENTE")),i.dipartimento||e.patErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.STRUTTURA"))||e.patErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.STRUTTURA")),i.note||e.patErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.motivazioneRichiesta"))||e.patErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.motivazioneRichiesta")),e.datiDomanda.responsabilitaRichieste.responsabilitaPat[0].allegato||e.patErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))||e.patErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))})),this.patErrorList.length>0&&this.messageService.add(s.a.getToast("tst",s.b.error,'Per la responabilit\xe0 "Dipendente/Collaboratore PAT" non sono stati compilati i campi: '+this.patErrorList.toString()))}},{key:"verificaValiditaCaa",value:function(){var e=this;this.datiDomanda.responsabilitaRichieste.responsabilitaCaa.forEach((function(i){0!==i.sedi.length||e.caaErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.CAA_SEDI"))||e.caaErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.CAA_SEDI")),i.responsabile||e.caaErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.RESPONSABILE"))||e.caaErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.RESPONSABILE")),i.allegato||e.caaErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))||e.caaErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE")),e.caaErrorList.length>0&&e.messageService.add(s.a.getToast("tst",s.b.error,'Per la responabilit\xe0 "Dipendente/Collaboratore CAA" non sono stati compilati i campi: '+e.caaErrorList.toString()))}))}},{key:"verificaValiditaLegaleRappresentante",value:function(){var e=this;this.datiDomanda.responsabilitaRichieste.responsabilitaLegaleRappresentante.forEach((function(i){i.cuaa||e.legaleRappresentanteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.CAA_SEDI"))||e.legaleRappresentanteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.CAA_SEDI")),i.denominazione||e.legaleRappresentanteErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.DESC_IMPRESA"))||e.legaleRappresentanteErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.DESC_IMPRESA"))})),this.legaleRappresentanteErrorList.length>0&&this.messageService.add(s.a.getToast("tst",s.b.error,'Per la responabilit\xe0 "Titolare Impresa / Legale Rappresentante" non sono stati compilati i campi: '+this.legaleRappresentanteErrorList.toString()))}},{key:"verificaValiditaDistributore",value:function(){var e=this;this.datiDomanda.responsabilitaRichieste.responsabilitaDistributore.forEach((function(i){i.distributori.length||e.distributoreErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.DISTRIBUTORI")),i.responsabile||e.distributoreErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.RESPONSABILE"))||e.distributoreErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.RESPONSABILE")),i.allegato||e.distributoreErrorList.includes(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE"))||e.distributoreErrorList.push(e.translateService.instant("RICHIESTE_ACCESSO.AUTORIZZAZIONE")),e.distributoreErrorList.length>0&&e.messageService.add(s.a.getToast("tst",s.b.error,'Per la responabilit\xe0 "Dipendente/Collaboratore Distributore" non sono stati compilati i campi: '+e.distributoreErrorList.toString()))}))}},{key:"checkDatiAnagrafici",value:function(e){var i=!0,t="";return this.controlliDatiAnagrafici.forEach((function(a){e.form.controls[a]&&e.form.controls[a].valid||(i=!1,t=t+a+", ")})),i?(console.log(JSON.stringify(this.datiAnagraficiUtente)),!0):(this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_DATI_ANAGRAFICI(t.slice(0,-2)))),!1)}},{key:"checkProfiliRichiesti",value:function(e){return console.log("checkProfiliRichiesti"),console.log(this.selectedApplicativi),!(!this.selectedApplicativi||0===this.selectedApplicativi.length)||(this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_SERVIZI)),!1)}},{key:"checkResponsabilita",value:function(){return!(!this.componentsReferences||0===this.componentsReferences.length)||(this.messageService.add(s.a.getToast("tst",s.b.error,s.a.ERRORE_RESPONSABILITA)),!1)}},{key:"popolaResponsabilita",value:function(){var e=this,i=new S;return this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita==b.TI&&e.instance.isValid})).forEach((function(e,t){i.responsabilitaTitolare||(i.responsabilitaTitolare=new Array),i.responsabilitaTitolare.push(new E(e.instance.cuaa,e.instance.denominazione))})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.LR&&e.instance.isValid})).forEach((function(e,t){i.responsabilitaLegaleRappresentante||(i.responsabilitaLegaleRappresentante=new Array),e.instance.elencoCariche.forEach((function(e){i.responsabilitaLegaleRappresentante.push(new E(e.cuaa,e.denominazione))}))})),console.log("Selected"),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.CAA})).forEach((function(t,a){var n=t.instance;i.responsabilitaCaa||(i.responsabilitaCaa=new Array),console.log(n),i.responsabilitaCaa.push(new g(n.index,n.responsabile,e.popolaSedi(n.selectedNodes),n.fileAutorizzazione))})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.PAT})).forEach((function(e,t){var a=e.instance;i.responsabilitaPat||(i.responsabilitaPat=new Array),console.log(a),i.responsabilitaPat.push(new v(a.index,a.matricola,a.dirigente,a.dipartimento,a.fileAutorizzazione,a.note))})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.ALTRI})).forEach((function(e,t){var a=e.instance;i.responsabilitaAltriEnti||(i.responsabilitaAltriEnti=new Array),console.log(a),i.responsabilitaAltriEnti.push(new h(a.index,a.denominazione,a.piva,a.dirigente,a.fileAutorizzazione,a.note))})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.LPC})).forEach((function(e,t){var a=e.instance;i.responsabilitaConsulente||(i.responsabilitaConsulente=new Array),console.log(a),i.responsabilitaConsulente.push(new m(a.index,a.ordine,a.iscrizione,a.cuaa,a.denominazione,a.rappresentante,a.fileAutorizzazione))})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.DIPENDENTE_DISTRIBUTORE})).forEach((function(e,t){var a=e.instance;i.responsabilitaDistributore||(i.responsabilitaDistributore=new Array),i.responsabilitaDistributore.push(new Re(a.index,a.responsabile,a.selectedDistributors,a.fileAutorizzazione))})),i}},{key:"rimuoviAllegati",value:function(){console.log("Selected"),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.CAA})).forEach((function(e,i){var t=e.instance;t.fileAutorizzazione=null,t.icon="ui-icon-file-upload",t.isValid=!1,t.uploadOk=!1})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.PAT})).forEach((function(e,i){var t=e.instance;t.fileAutorizzazione=null,t.icon="ui-icon-file-upload",t.isValid=!1,t.uploadOk=!1})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.ALTRI})).forEach((function(e,i){var t=e.instance;t.fileAutorizzazione=null,t.icon="ui-icon-file-upload",t.isValid=!1,t.uploadOk=!1})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.LPC})).forEach((function(e,i){var t=e.instance;t.fileAutorizzazione=null,t.icon="ui-icon-file-upload",t.isValid=!1,t.uploadOk=!1})),this.componentsReferences.filter((function(e){return e.instance.codeResponsabilita===b.DIPENDENTE_DISTRIBUTORE})).forEach((function(e,i){var t=e.instance;t.fileAutorizzazione=null,t.icon="ui-icon-file-upload",t.uploadOk=!1}))}},{key:"popolaApplicativi",value:function(){var e=[];return console.log(this.selectedApplicativi),this.selectedApplicativi.forEach((function(i){e.push(i.label)})),e}},{key:"popolaSedi",value:function(e){var i=new Array;return e&&e.forEach((function(e,t){e.data&&i.push(e.data)})),i}},{key:"inserisci",value:function(){var e=this;console.log("Inzio POST"),this.utentiService.inserisciDomanda(this.datiDomanda).subscribe((function(i){console.log("Inserimento della domanda "+i+" avvenuta con successo"),e.modificaStatoRichiesta(),e.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)),e.datiDomanda.id=i,e.ricaricaDati(),e.saveOk=!0}),(function(i){console.error("Errore in inserisciDomanda: "+i),s.a.handleError(e.messageService,i,s.a.SALVATAGGIO_RICHIESTA_UTENTE)}))}},{key:"aggiorna",value:function(){var e=this;console.log("Inzio PUT"),this.utentiService.aggiornaDomanda(this.datiDomanda).subscribe((function(i){console.log("Aggiornamento della domanda "+i+" avvenuta con successo"),e.modificaStatoRichiesta(),e.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK)),e.datiDomanda.id=i,e.ricaricaDati(),e.saveOk=!0}),(function(i){console.error("Errore in aggiornaDomanda: "+i),s.a.handleError(e.messageService,i,s.a.SALVATAGGIO_RICHIESTA_UTENTE)}))}},{key:"ricaricaDati",value:function(){}},{key:"downloadInformativaPrivacy",value:function(){var e=this;this.http.get(this._configuration.UrlGetInfoPrivacy,{responseType:"blob"}).subscribe((function(i){o.saveAs(i,"informativa_privacy.pdf"),e.viewPrivacy=!0,e.informativaPrivacyFile=e.blobToFile(i,"informativa_privacy.pdf")}))}},{key:"sottoScriviPrivacyCheck",value:function(e){console.log("Evento sottoscrivi privacy",e.checked),e.checked&&this.sottoScriviPrivacy()}},{key:"sottoScriviPrivacy",value:function(){var e=this;this.utentiService.sottoScriviPrivacy(this.informativaPrivacyFile).subscribe((function(i){e.firmaPrivacy=i,console.log("Firmata privacy con xml",e.firmaPrivacy.xml),e.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK));for(var t=atob(e.firmaPrivacy.pdf),a=new Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);var r=new Uint8Array(a),l=new Blob([r],{type:"application/pdf"});console.log(l),e.informativaPrivacyFirmataPDF=e.blobToFile(l,"informativa_privacy_firmata.pdf"),o.saveAs(l,"informativa_privacy_firmata.pdf"),e.blockCheckPrivacyOk=!0}),(function(i){console.error("Errore in aggiornaDomanda: "+i),s.a.handleError(e.messageService,i,s.a.FIRMA_PRIVACY),e.checked1=!1}))}},{key:"downloadModuloRichiestaAccesso",value:function(){var e=this;console.log(this.datiDomanda),this.saveOk&&this.domandaPDF().subscribe((function(i){e.viewModuloDomanda=!0}),(function(i){console.log("Errore stampando il modulo",i),s.a.handleError(e.messageService,i,s.a.STAMPA_RICHIESTA_UTENTE)}))}},{key:"sottoScriviDomandaCheck",value:function(e){console.log("Evento sottoscrivi domanda",e.checked),e.checked&&this.sottoScriviDomanda()}},{key:"sottoScriviDomanda",value:function(){var e=this;this.utentiService.sottoScriviDomanda(this.datiDomanda.id).subscribe((function(i){e.messageService.add(s.a.getToast("tst",s.b.success,s.a.OPERAZIONE_OK))}),(function(i){console.error("Errore in aggiornaDomanda: "+i),s.a.handleError(e.messageService,i,s.a.FIRMA_RICHIESTA_UTENTE),e.checked2=!1}))}},{key:"domandaPDF",value:function(){return this.utentiService.getDomanda(this.datiDomanda.id,this.datiDomanda.datiAnagrafici.codiceFiscale)}},{key:"startProtocollazioneAsincrona",value:function(){var e=this;if(this.canProtocol=!1,this.hasPrivacyProtocollata)this.utentiService.protocollaDomanda(this.datiDomanda.id).subscribe((function(){e.messages.add(s.a.getToast("tst-protocolla",s.b.success,e.translateService.instant("RICHIESTE_ACCESSO.protocollazioneInCarico")))}),(function(i){e.messages.add(s.a.getToast("tst",s.b.error,s.a.PROTOCOLLA_INFORMATIVA_ANTIMAFIA_ERROR)),e.canProtocol=!0}));else{var i=this.getDocumentazioneInformativaPrivacy(),t=new Array;t.push(this.informativaPrivacyFirmataPDF),t.push(this.getInfoPrivacyFirmataXML()),(s.a.isUndefinedOrNull(this.persona)||s.a.isUndefinedOrNull(this.persona.id))&&(console.log("Persona non esistente; fornisco i dati per la creazione"),this.persona=new l.a,this.persona.codiceFiscale=this.datiAnagraficiUtente.codiceFiscale,this.persona.nome=this.datiAnagraficiUtente.nome,this.persona.cognome=this.datiAnagraficiUtente.cognome),this.utentiService.protocollaDomanda(this.datiDomanda.id).pipe(Object(r.a)((function(a){return e.utentiService.protocollaInformativaPrivacyDichiarazioneAntimafia(e.persona.nome,e.persona.cognome,e.persona.codiceFiscale,i,e.informativaPrivacyFile,t)}))).subscribe((function(i){e.messages.add(s.a.getToast("tst-protocolla",s.b.success,e.translateService.instant("RICHIESTE_ACCESSO.protocollazioneInCarico")))}),(function(i){e.messages.add(s.a.getToast("tst",s.b.error,s.a.PROTOCOLLA_DOMANDA_ACCESSO_ERROR))}))}}},{key:"getDocumentazioneInformativaPrivacy",value:function(){var e=this._configuration.ProtocollaPrivacyOggetto+" - "+this.datiAnagraficiUtente.nome+" "+this.datiAnagraficiUtente.cognome+" - "+this.datiAnagraficiUtente.codiceFiscale,i=this._configuration.tipologiaDocumentoProtocolloPrivacy,t={name:this.datiAnagraficiUtente.nome,surname:this.datiAnagraficiUtente.cognome,email:s.a.isUndefinedOrNull(this.datiAnagraficiUtente.email)?null:this.datiAnagraficiUtente.email,nationalIdentificationNumber:this.datiAnagraficiUtente.codiceFiscale,description:this.datiAnagraficiUtente.nome+" "+this.datiAnagraficiUtente.cognome+" - "+this.datiAnagraficiUtente.codiceFiscale};return JSON.stringify({mittente:t,oggetto:e,tipologiaDocumentoPrincipale:i})}},{key:"onCloseMessageProtocolla",value:function(){window.location.href=this.configuration.IndexPage}},{key:"getInfoPrivacyFirmataXML",value:function(){for(var e=atob(btoa(encodeURIComponent(this.firmaPrivacy.xml).replace(/%([0-9A-F]{2})/g,(function(e,i){return String.fromCharCode(parseInt(i,16))})))),i=new Array(e.length),t=0;t<e.length;t++)i[t]=e.charCodeAt(t);var a=new Uint8Array(i),n=new Blob([a],{type:"application/xml"});return console.log(n),this.blobToFile(n,"informativa_privacy_firmata.xml")}}]),e}()).\u0275fac=function(e){return new(e||Ke)(n.Nb(d.a),n.Nb(T.a),n.Nb(n.j),n.Nb(y.d),n.Nb(u.a),n.Nb(X.b),n.Nb(y.d),n.Nb(u.a),n.Nb(U.e))},Ke.\u0275cmp=n.Hb({type:Ke,selectors:[["app-utente"]],viewQuery:function(e,i){var t;1&e&&n.Uc(Be,!0,n.O),2&e&&n.Ac(t=n.cc())&&(i.VCR=t.first)},decls:26,vars:8,consts:[[1,"ui-g","ui-fluid"],[1,"tophome"],[1,"ui-grid-fixed"],["key","tst"],["position","top-center","key","tst-protocolla","modal","true",3,"baseZIndex","onClose"],[1,"ui-g-12"],[3,"ngSubmit",4,"ngIf"],["fAutorizzazioni","ngForm"],[3,"disabled"],[1,"accordion-wrapper"],["header","Autorizzazioni",3,"selected"],["pTooltip","Dopo aver visualizzato i documenti Informativa privacy e Modulo richiesta accesso sar\xe0 possibile attivare la relativa Firma Accettazione e procedere con la protocollazione della richiesta","tooltipPosition","top",1,"boxgrey-user"],[1,"ui-g"],["pTemplate","header"],[1,"ui-g-9"],[1,"ui-g-3"],[1,"next-button"],["pButton","","icon","ui-icon-check","type","button","label","PROTOCOLLA RICHIESTA","pButton","",3,"disabled","click"],[3,"ngSubmit"],["f","ngForm"],["header","Anagrafica",3,"selected"],["pTooltip","I campi contrassegnati con l'asterisco sono obbligatori!","tooltipPosition","top",3,"disabled"],[1,"boxgrey-user"],[1,"ui-g-2"],[1,"ui-g-4"],["type","text","name","cognome","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","nome","required","","pInputText","",3,"ngModel","ngModelChange"],["type","text","name","codiceFiscale","pInputText","","required","","appValidaCf","",3,"ngModel","readonly","ngClass","ngModelChange"],["cfInput","ngModel"],[4,"ngIf"],["type","text","name","email","required","","appValidaEmail","","pInputText","",3,"ngModel","ngModelChange"],["emailinput","ngModel"],["type","text","name","telefono","required","","appValidaTelefono","","pInputText","",3,"ngModel","ngModelChange"],["telefonoinput","ngModel"],[1,"ui-g-6"],["header","Responsabilit\xe0",3,"selected"],["pTooltip","Selezionare la Responsabilit\xe0 e premere il pulsante Aggiungi (+)","tooltipPosition","top",1,"boxgrey-user"],[1,"ui-g-11"],["name","selectedResponsabilita",3,"options","ngModel","disabled","ngModelChange"],[1,"ui-g-1"],["pButton","","type","button","icon","ui-icon-add",3,"title","disabled","click"],["viewContainerRef",""],["header","Applicativi",3,"selected"],["pTooltip","Selezionare l'applicativo, o gli applicativi, desiderati. Se sono stati compilati tutti i dati, sar\xe0 possibile premere il pulsante Salva","tooltipPosition","top","escape","false",1,"boxgrey-user"],["name","applicativi","multiple","multiple","checkbox","checkbox","optionLabel","title","defaultLabel","Seleziona applicativo/i","required","",3,"filter","options","ngModel","disabled","ngModelChange"],[1,"ui-g-8"],[1,"back-button","sm"],["pButton","","icon","ui-icon-edit","type","button","label","Modifica","pButton","",1,"blue-grey-btn",3,"disabled","click"],[1,"next-button","sm"],["pButton","","icon","ui-icon-save","type","submit","label","Salva","pButton","",3,"disabled"],["class","ui-message ui-messages-error ui-corner-all",4,"ngIf"],[1,"ui-message","ui-messages-error","ui-corner-all"],[3,"routerLink","click"],["name","checked1",3,"ngModel","disabled","ngModelChange","onChange"],[3,"routerLink","click",4,"ngIf"],["name","checked2",3,"ngModel","disabled","ngModelChange","onChange"]],template:function(e,i){1&e&&(n.Tb(0,"div",0),n.Tb(1,"div",1),n.Tb(2,"div",2),n.Tb(3,"h4"),n.Oc(4,"CREAZIONE/MODIFICA PROFILO SISTEMA INFORMATIVO AGRICOLTURA"),n.Sb(),n.Sb(),n.Sb(),n.Ob(5,"p-toast",3),n.Tb(6,"p-toast",4),n.bc("onClose",(function(){return i.onCloseMessageProtocolla()})),n.Sb(),n.Tb(7,"div",2),n.Tb(8,"div",5),n.Mc(9,Ze,64,28,"form",6),n.Sb(),n.Tb(10,"div",5),n.Tb(11,"form",null,7),n.Tb(13,"fieldset",8),n.Tb(14,"div",9),n.Tb(15,"p-accordion"),n.Tb(16,"p-accordionTab",10),n.Tb(17,"div",11),n.Tb(18,"div",12),n.Tb(19,"div",5),n.Tb(20,"p-table"),n.Mc(21,Qe,19,7,"ng-template",13),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Ob(22,"div",14),n.Tb(23,"div",15),n.Tb(24,"div",16),n.Tb(25,"button",17),n.bc("click",(function(){return i.startProtocollazioneAsincrona()})),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()),2&e&&(n.Bb(5),n.Kc(n.rc(7,Je)),n.Bb(1),n.mc("baseZIndex",5e4),n.Bb(3),n.mc("ngIf",i.datiAnagraficiUtente),n.Bb(4),n.mc("disabled",!i.inserimentoDisabled),n.Bb(3),n.mc("selected",!0),n.Bb(9),n.mc("disabled",!(i.checked1&&i.checked2&&i.inserimentoDisabled&&i.canProtocol)))},directives:[R.a,Z.t,k.I,k.t,k.u,Ie.a,Ie.c,Oe.a,ce.q,y.e,O.b,k.c,k.D,D.a,k.s,k.v,ke.a,Z.q,ze.a,De.a,Pe.a,Fe.a,a.h,Le.a],styles:[""]}),Ke),$e=t("PcGO"),Xe=t("39Yt"),ei=[{path:"",component:Ye,canActivate:[$e.a]},{path:"modificaUtente",component:Ye,canActivate:[Xe.a]}],ii=((je=function e(){_classCallCheck(this,e)}).\u0275mod=n.Lb({type:je}),je.\u0275inj=n.Kb({factory:function(e){return new(e||je)},imports:[[a.i.forChild(ei)]]}),je),ti=t("R69K"),ai=t("SLJP"),ni=t("P028"),oi=t("R5y+"),ri=((We=function e(){_classCallCheck(this,e)}).\u0275mod=n.Lb({type:We}),We.\u0275inj=n.Kb({factory:function(e){return new(e||We)},providers:[T.a],imports:[[ii,ti.a,Pe.b,Ie.b,ni.a,ai.b,G.b,oi.b]]}),We)}}]);